<!DOCTYPE html>
<html lang="en">
<style>
    body {
        font-family: Arial;
    }

    /* Style the tab */
    .tab {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
    }

    /* Style the buttons inside the tab */
    .tab button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
    }

    /* Change background color of buttons on hover */
    .tab button:hover {
        background-color: #ddd;
    }

    /* Create an active/current tablink class */
    .tab button.active {
        background-color: #ccc;
    }

    /* Style the tab content */
    .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
    }

    select {
        color: black;
    }

    select.item-select {
        width: 150px;
        /*background-color: #ccccff;*/
    }

    select.weapon-select {
        width: 225px;
        /*background-color: #ccccff;*/
    }

    select.item-select {
        width: 150px;
        /*background-color: #ccccff;*/
    }

    option:checked {
        color: #000066;
        background-color: #b3c6ff;
    }

    select.enchant-select {
        width: 100px;
    }

    .run_sim_button {
        background-color: #4CAF50;
        border: none;
        color: white;
        padding: 15px 32px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        margin: 4px 2px;
        cursor: pointer;
    }

    /* Change background color of buttons on hover */
    .run_sim_button:hover {
        background-color: #adebad;
    }

    .collapsible {
        background-color: #777;
        color: white;
        cursor: pointer;
        padding: 18px;
        width: 600px;
        border: 1px solid black;
        text-align: center;
        outline: none;
        font-size: 15px;
    }

    .collapsible:hover {
        background-color: #555;
    }

    .content {
        padding: 18px;
        display: none;
        overflow-y: scroll;
        max-height: 480px;
        width: 600px;
        background-color: #d9d9d9;
    }

    .loader div {
        border: 16px solid #f3f3f3; /* Light grey */
        border-top: 16px solid #003300; /* Blue */
        border-radius: 50%;
        width: 120px;
        height: 120px;
        animation: spin 2s linear infinite;
    }

    p.select-title {
        display: inline;
        font-size: 22px;
        font-weight: bold;
    }

    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }
        25% {
            transform: rotate(180deg);
        }
        50% {
            transform: rotate(0deg);
        }
        75% {
            transform: rotate(-180deg);
        }
        100% {
            transform: rotate(0deg);
        }
    }

    div.scroll {
        margin: 4px;
        padding: 4px;
        background-color: black;
        color: white;
        width: 600px;
        height: 400px;
        overflow-x: hidden;
        overflow-x: auto;
        text-align: justify;
    }

    div.description {
        margin-left: 25px;
    }

    .left_select {
        position: relative;
        left: 00px;
        /*margin-left: -0px;*/
    }

    .middle_select {
        position: relative;
        left: 124px;
        /*margin-left: -50px;*/
    }

    .right_select {
        position: relative;
        left: 240px;
        /*margin-left: 50px;*/
    }
</style>

<head>
    <title>wow fury sim</title>
</head>

<h1>wow fury sim</h1>

<body style="background-color:#bfbfbf;" onload="openTab('event', 'Simulator');open_armor()">

<div class="tab">
    <button class="tablinks" onclick="openTab(event, 'Simulator')">Simulator</button>
    <button class="tablinks" onclick="openTab(event, 'About')">About</button>
    <button class="tablinks" onclick="openTab(event, 'Equations')">Equations</button>
    <button class="tablinks" onclick="openTab(event, 'Coming soon')">Coming soon</button>
    <button class="tablinks" onclick="openTab(event, 'Change log')">Change log</button>
</div>

<div id="About" class="tabcontent">
    <h2>Welcome to my fury simulator!</h2>

    <h3><a href="https://discord.gg/xTuKsRz">Discord link</a></h3>
    <h3><a href="https://github.com/albinoyoda/wow_classic_simulator">Github link</a></h3>

    <h3>FAQ:</h3>
    <p><b>Q: Is this a spreadsheet? How does it work? </b></p>
    <p> A: No, this is not a spreadsheet. This is an actual simulator with world of warcraft classic mechanics.<br/>
        When the "Run simulator" button is pressed, a character is created, wearing the items, weapons, buffs, and<br/>
        enchants specified by the drop down menus and checkboxes. Then the following values, which are used <br/>
        in the simulator, are computed:<br/>
        - Total attack power<br/>
        - Weapon skill<br/>
        - Hit chance<br/>
        - Haste rating<br/>
        - Weapons extra hit probability<br/>
        - Damage multipliers<br/><br/>
        Where the hit and crit are used to create the following hit tables:<br/>
        - Main-hand white-hit table<br/>
        - Off-hand white-hit table<br/>
        - Two-hand white-hit table (queried for the off-hand when a heroic strike is queued)<br/>
        - Yellow-hit table<br/><br/>
        Then a combat phase starts, where X independent fights are simulated. Here the characters weapons will<br/>
        start to swing towards a target, where white and yellow hits are generated by drawing random samples<br/>
        from the hit-tables. Rage will be generated and spent on abilities following a configurable ability-policy.<br/>
        The DPS can then be computed as the average value of the DPS in these simulations. Furthermore, since the<br/>
        DPS from the simulations approximate a gaussian distribution, one can readily compute the error margins <br/>
        of the expected value (confidence interval). This is crucial in order draw assumptions from the results.<br/>
    </p>
    <p><b>Q: Whats the difference between a simulator and a spreadsheet?</b></p>
    <p>A: A spreadsheet performs no simulations, instead it consists of a mash-up of expected values, where<br/>
        white-hit damage, rage, yellow hits, etc., are modelled. But, since these depend on discrete events, such<br/>
        as cooldowns, flurry charges, rage-capping, swing timer resets (extra hit), the models will be approximate<br/>
        and might thus lack crucial details. I believe people have done a great effort in developing such models,<br/>
        but from the forementioned reasons they will never be as accurate as a simulator!<br/>
    </p>
    <p><b>Q: What equations are used in this simulator?</b></p>
    <p>A: The tables for crit, hit, glancing hits, and weapon skill have all been based on the results presented in<br/>
        the <a href="https://github.com/magey/classic-warrior/wiki/Attack-table">Attack table</a> github.<br/>
        Their models have been verified on classic servers, and I can strongly recommend to check it out.<br/>
    </p>
    <p><b>Q: The DPS in the simulator is much higher than what I usually get when I raid. What is wrong?</b></p>
    <p>A: The bot "playing" in the simulator follows the a the specified ability rotation with perfect execution,<br>
        meaning it does 0 misstakes, 0 missclicks and has near perfect timing with all of its cooldowns.<br>
        Furthermore, so does all of it's "raid members", where fearie fire, curse of recklessness,<br>
        and sunder armor are assumed to be applied instantly as the fight begins and have no downtime. The bot also<br>
        does not wait for the tank to build threat, but, rather, it starts to DPS as soon as the timer starts.<br>
        In the future there will be more modes added where these factors can be set more realistically, with<br>
        latency added to abilities and downtime to armor reduction etc. While this will reduce the DPS in the<br>
        simulations, it wont affect what items that are superior to others, since all items can be assumed to<br>
        be affected by this in the same way (except for perhaps badge of the swarmguard and other use effects.)<br>
    </p>
    <p><b>Q: Wow, I really love the webdesign from the 90's! </b></p>
    <p>A: Said no one ever...<br/>
        The reason why this page looks to have a target audience in their 50's is that I have very limited<br/>
        experience with any web based programming languages. I found something that I understood and stuck to that.<br/>
        And it works, hey! However, the C++ based simulator and the derivation/interpretation of the results should<br/>
        be of higher quality, since they are closed to my field of expertise<br/>
    </p>
</div>

<div id="Equations" class="tabcontent">
    <h2>Details about the simulator will be coming soon!</h2>
</div>

<div id="Change log" class="tabcontent">
    <h2>Change log:</h2>
    <p><b>2020-05-29:</b></p>
    <p>-Reworked "use effects": Now cloudkeepers, diamond flask, mighty rage potion, etc., adds an aura that is <br/>
        tracked in the simulator. These auras take into account stat-multipilers, triggers GCD <br/>
        (if it should) and has proper buff slots. As an example consider a character with both cloudkeepers and<br/>
        diamondflask. Then the simulator will pick the best one (best = max(AP bonus * uptime)) and use that one<br/>
        It will also stack all effects towards the end so that the uptime ends roughly when the fight ends<br/>
        (stacking buffs towards the execute phase).<br/>
        - Fixed the simulation output formatting.
    </p>
    <p><b>2020-05-29:</b></p>
    <p> -Changed the item names to be capitalized and without underscores. Also, now main-hand and off-hand items <br/>
        are only possible to select in their respective drop down menus.
    </p>
    <p><b>2020-05-29:</b></p>
    <p> -Added combat debug information. When this is checked a window will be shown in the results section that <br/>
        contains a complete fight log. At the bottom om this log detailed fighting stats are displayed. <br/>
        NOTE: In the log, rage gained will sometimes be different when the same amount of damage is dealt.<br/>
        This is due to the printout being rounded down, where in reality the rage is a floating point number in <br/>
        the simulator. The same phenomena can be seen in the wow client aswell.<br/>
    </p>
    <p><b>2020-05-31:</b></p>
    <p> - Can now select what stat weights to compute (increases performance, since these are expensive)<br/>
        - Added BOSSES!! now its possible to select different boss scenarios to test the item configuration against<br/>
        more bosses will come soon.<br/>
        - Added the cleave ability.<br/>
        - Combat debug log displays the median fight.<br/>
        <br/>
    </p>
    <p><b>2020-06-01:</b></p>
    <p> - Fixed the armor values for the adds in the bossfights.<br/>
        - Added the ZG item-set. <br/>
        <br/>
    </p>
    <p><b>2020-06-02:</b></p>
    <p>
        - Added AQ item-set!!! Finally we got Badge of the swarmguard (thats a dirty item to implement) and more!<br/>
        - Fixed the back-ends memory handling. Now the app uses a constant amount of memory, and<br/>
        does no longer scale with the number of simulations. (Max number of runs now are increased to 1.000.000.)<br/>
        - Fixed the "proc counter" for items with elemental damage, e.g., Thunder fury.<br/>
    </p>
    <p><b>2020-06-08:</b></p>
    <p>
        - Comparison functionality, which computes the stat/DPS difference of selected items vs. a load file.<br/>
        - Added more items: Defiler set, fang of the faceless, blackguard, and some more.<br/>
        - Hamstring can now be configured in the simulation settings.<br/>
        - Initial rage is now a variable.<br/>
        - Added a tracker for the number of off-hand hits which got benefits from the "heroic strike bug", also <br/>
        works on cleave. <br/>
    </p>
    <p><b>2020-06-27:</b></p>
    <p>
        - Multi-select! When this is selected its possible to enter multiple items from the same slot. This is<br/>
        usefull if you have alot of different promising items and want some help with finding the best<br/>
        possible configuration of these. It uses a probabilistic framework, so results from run to run may vary.<br/>
        If it produces weird/scattered results for a specified set of items try increasing the maximum allowed<br/>
        simulation time for the optimizer, which will increase the performance.<br/>
        - Some small appearance changes and bugfixes.
    </p>
    <p><b>2020-07-13:</b></p>
    <p>
        - Fixed the windfury implementation and the impale talent to work correctly.<br/>
        - Added double rolls for yellow hits.<br/>
        - Improved simulator runtime performance<br/>
        - Fixed a bug where the aura uptimes no longer where showing when doing a standard simulation.<br/>
    </p>
    <p><b>2020-08-01:</b></p>
    <p>
        - Added item proposal functionality under "Armor and Weapons -> Standard" which, if enabled, will propose<br/>
        one or several items for each slot which will improve the results in the simulator. (does not propose<br/>
        weapons at the moment, but that will come soon.)<br/>
        - Added better implementations of all "over time" effects, such as Deep wounds, Essence of the red, <br/>
        anger management, etc. Now they properly tick with a batch window.<br/>
        - Deep wounds DPS added to the plots and average DPS. This will results in an increased DPS. However, this <br/>
        should not effect any BiS lists or such, since affects all item combinations in approximately the same<br/>
        way.<br/>
        - HOTFIX: Heroic strike now properly refunds rage when dodged/missed.<br/>
    </p>
    <p><b>2020-09-25:</b></p>
    <p>
        - Added weapon upgrade proposals!<br/>
        - HOTFIX: there was a bug in the multi select which made it to not evaluate all different<br/>
        main-hand/off-hand combinations.<br/>
    </p>

</div>

<div id="Coming soon" class="tabcontent">
    <h2>Stuff to be added soon:</h2>
    <p>TPS calculator for tanking. </p>
    <p>Item filters, will reduce the size of the drop down menus </p>
    <p>Hover-over item display </p>
    <p>Configure use effect timings. </p>
    <p>Talents </p>
    <p>2h fury support </p>
</div>

<div id="Simulator" class="tabcontent">

    <p class="select-title">Load config from file:</p><br>
    <input type="file" id="myFile" name="filename" accept=".txt">
    <input type="submit" onclick="load_file()"><br><br>

    <p class="select-title">Save config to file:</p><br>
    <button onclick="save_button()">Save current config</button>
    <br><br>

    <button type="button" class="collapsible" id="armor_n_wep">Armor and Weapons</button>
    <div class="content">
        <div id="armor_single">
            <p class="select-title">Quick-select:</p><br>
            <button onclick="load_p1prebis()">Phase 1 "pre-BiS"</button>
            <button onclick="load_p3pvebis()">Phase 3 PvE-BiS</button>
            <button onclick="load_p4pvebis()">Phase 4 PvE-BiS</button>
            <button onclick="load_p5pvebis()">Phase 5 PvE-BiS</button>
            <br><br>
            <!--armor begin-->
            <span class="left_select">helmet</span><span class="middle_select">neck</span><span class="right_select">shoulder</span><br>
            <select id="helmet_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="circlet_of_restless_dreams">Circlet of restless dreams</option>
                <option value="conquerors_crown">Conquerors crown</option>
                <option value="crown_of_destruction">Crown of destruction</option>
                <option value="expert_goldminers_head">Expert goldminers head</option>
                <option value="eye_of_rend">Eye of rend</option>
                <option value="fury_visor">Fury visor</option>
                <option value="helm_of_domination">Helm of domination</option>
                <option value="helm_of_endless_rage">Helm of endless rage</option>
                <option value="helm_of_heroism">Helm of heroism</option>
                <option value="helm_of_the_executioner">Helm of the executioner</option>
                <option value="helm_of_valor">Helm of valor</option>
                <option value="lionheart_helm">Lionheart helm</option>
                <option value="mask_of_the_unforgiven">Mask of the unforgiven</option>
                <option value="r10_commanders_plate_helm">R10 commanders plate helm</option>
                <option value="r13_plate_helm">R13 plate helm</option>
            </select>

            <select id="neck_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="amulet_of_the_darkmoon">Amulet of the darkmoon</option>
                <option value="barbed_choker">Barbed choker</option>
                <option value="beads_of_ogre_might">Beads of ogre might</option>
                <option value="choker_of_the_shifting_sands">Choker of the shifting sands</option>
                <option value="fury_of_the_forgotten_swarm">Fury of the forgotten swarm</option>
                <option value="imperial_jewel">Imperial jewel</option>
                <option value="mark_of_fordring">Mark of fordring</option>
                <option value="onyxia_tooth_pendant">Onyxia tooth pendant</option>
                <option value="prestors_talisman_of_connivery">Prestors talisman of connivery</option>
                <option value="the_eye_of_hakkar">The eye of hakkar</option>
            </select>

            <select id="shoulder_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="abyssal_plate_epaulets">Abyssal plate epaulets</option>
                <option value="black_dragonscale_shoulders">Black dragonscale shoulders</option>
                <option value="bloadsoaked_pauldrons">Bloadsoaked pauldrons</option>
                <option value="chitinous_shoulderguards">Chitinous shoulderguards</option>
                <option value="conquerors_spaulders">Conquerors spaulders</option>
                <option value="defilers_plate_spaulders">Defilers plate spaulders</option>
                <option value="drake_talon_pauldrons">Drake talon pauldrons</option>
                <option value="flamescarred_shoulders">Flamescarred shoulders</option>
                <option value="mantle_of_wicked_revenge">Mantle of wicked revenge</option>
                <option value="pauldrons_of_the_unrelenting">Pauldrons of the unrelenting</option>
                <option value="r10_commanders_plate_shoulders">R10 commanders plate shoulders</option>
                <option value="r13_plate_shoulderguards">R13 plate shoulderguards</option>
                <option value="razorsteel_shoulders">Razorsteel shoulders</option>
                <option value="spaulders_of_heroism">Spaulders of heroism</option>
                <option value="spaulders_of_valor">Spaulders of valor</option>
                <option value="truestrike_shoulders">Truestrike shoulders</option>
                <option value="wyrmhide_spaulders">Wyrmhide spaulders</option>
            </select>

            <p></p>

            <span class="left_select">back</span><span class="middle_select">chest</span><span class="right_select">wrists</span><br>
            <select id="back_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="blackveil_cloak">Blackveil cloak</option>
                <option value="cape_of_the_black_baron">Cape of the black baron</option>
                <option value="cloak_of_concentrated_hate">Cloak of concentrated hate</option>
                <option value="cloak_of_draconic_might">Cloak of draconic might</option>
                <option value="cloak_of_firemaw">Cloak of firemaw</option>
                <option value="cloak_of_the_fallen_god">Cloak of the fallen god</option>
                <option value="cloak_of_the_golden_hive">Cloak of the golden hive</option>
                <option value="cloak_of_the_shrouded_mists">Cloak of the shrouded mists</option>
                <option value="deathguards_cloak">Deathguards cloak</option>
                <option value="drake_of_unyielding_strength">Drake of unyielding strength</option>
                <option value="puissant_cape">Puissant cape</option>
                <option value="stoneskin_gargoyle_cape">Stoneskin gargoyle cape</option>
                <option value="windshear_cape">Windshear cape</option>
                <option value="zulian_tigerhide_cloak">Zulian tigerhide cloak</option>
            </select>

            <select id="chest_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="black_dragonscale_chest">Black dragonscale chest</option>
                <option value="bloodsoul_breastplate">Bloodsoul breastplate</option>
                <option value="breastplate_of_annihilation">Breastplate of annihilation</option>
                <option value="breastplate_of_bloodthirst">Breastplate of bloodthirst</option>
                <option value="breastplate_of_heroism">Breastplate of heroism</option>
                <option value="breastplate_of_the_chromatic_flight">Breastplate of the chromatic flight</option>
                <option value="breastplate_of_valor">Breastplate of valor</option>
                <option value="cadaverous_armor">Cadaverous armor</option>
                <option value="conquerors_breastplate">Conquerors breastplate</option>
                <option value="deathdealer_breastplate">Deathdealer breastplate</option>
                <option value="malfurions_blessed_bulwark">Malfurions blessed bulwark</option>
                <option value="obsidian_mail_tunic">Obsidian mail tunic</option>
                <option value="ogre_forged_hauberk">Ogre forged hauberk</option>
                <option value="r13_plate_armor">R13 plate armor</option>
                <option value="r8_plate_hauberk">R8 plate hauberk</option>
                <option value="runed_bloodstaind_hauberk">Runed bloodstaind hauberk</option>
                <option value="savage_gladiator_chain">Savage gladiator chain</option>
                <option value="tombstone_breastplate">Tombstone breastplate</option>
                <option value="vest_of_swift_execution">Vest of swift execution</option>
                <option value="zandalar_vindicators_breastplate">Zandalar vindicators breastplate</option>
            </select>

            <select id="wrists_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="abyssal_plate_vambraces">Abyssal plate vambraces</option>
                <option value="battleborn_armbraces">Battleborn armbraces</option>
                <option value="berserker_bracers">Berserker bracers</option>
                <option value="blinkstrike">Blinkstrike</option>
                <option value="bracers_of_brutality">Bracers of brutality</option>
                <option value="bracers_of_heroism">Bracers of heroism</option>
                <option value="deeprock_bracers">Deeprock bracers</option>
                <option value="hive_defiler_wristguards">Hive defiler wristguards</option>
                <option value="quiraji_execution_bracers">Quiraji execution bracers</option>
                <option value="vambraces_of_the_sadist">Vambraces of the sadist</option>
                <option value="wristguards_of_stability">Wristguards of stability</option>
                <option value="wristhuards_of_true_flight">Wristhuards of true flight</option>
                <option value="zandalar_armguards">Zandalar armguards</option>
            </select>

            <p></p>

            <span class="left_select">hands</span><span class="middle_select">belt</span><span
                class="right_select">legs</span><br>
            <select id="hands_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="aged_core_leather_gloves">Aged core leather gloves</option>
                <option value="bloodmail_gauntlets">Bloodmail gauntlets</option>
                <option value="devilsaur_gauntlets">Devilsaur gauntlets</option>
                <option value="edgemasters_handguards">Edgemasters handguards</option>
                <option value="flameguard_gauntlets">Flameguard gauntlets</option>
                <option value="gauntlets_of_annihilation">Gauntlets of annihilation</option>
                <option value="gauntlets_of_heroism">Gauntlets of heroism</option>
                <option value="gauntlets_of_might">Gauntlets of might</option>
                <option value="gauntlets_of_valor">Gauntlets of valor</option>
                <option value="gloves_of_enforcement">Gloves of enforcement</option>
                <option value="r12_plate_gauntlets">R12 plate gauntlets</option>
                <option value="r7_plate_gauntlets">R7 plate gauntlets</option>
                <option value="reiver_claws">Reiver claws</option>
                <option value="sacrificial_gauntlets">Sacrificial gauntlets</option>
            </select>

            <select id="belt_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="belt_of_heroism">Belt of heroism</option>
                <option value="belt_of_never_ending_agony">Belt of never ending agony</option>
                <option value="brigam_girdle">Brigam girdle</option>
                <option value="defilers_plate_girdle">Defilers plate girdle</option>
                <option value="frostwolf_plate_belt">Frostwolf plate belt</option>
                <option value="girdle_of_the_fallen_crusader">Girdle of the fallen crusader</option>
                <option value="mugglers_belt">Mugglers belt</option>
                <option value="omokks_girth_restrainer">Omokks girth restrainer</option>
                <option value="onslaught_girdle">Onslaught girdle</option>
                <option value="therazanes_link">Therazanes link</option>
                <option value="triad_girdle">Triad girdle</option>
                <option value="zandalar_vindicators_belt">Zandalar vindicators belt</option>
            </select>

            <select id="legs_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="abyssal_plate_legplates">Abyssal plate legplates</option>
                <option value="black_dragonscale_leggings">Black dragonscale leggings</option>
                <option value="blademaster_leggings">Blademaster leggings</option>
                <option value="bloodsoaked_legplates">Bloodsoaked legplates</option>
                <option value="cloudkeeper_legplates">Cloudkeeper legplates</option>
                <option value="cloudkeeper_legplates_no_use">Cloudkeeper legplates no use</option>
                <option value="conquerors_legguards">Conquerors legguards</option>
                <option value="dark_heart_pants">Dark heart pants</option>
                <option value="devilsaur_leggings">Devilsaur leggings</option>
                <option value="eldritch_legplates">Eldritch legplates</option>
                <option value="handcrafted_mastersmith_leggings">Handcrafted mastersmith leggings</option>
                <option value="legguards_of_the_fallen_crusader">Legguards of the fallen crusader</option>
                <option value="legplates_of_heroism">Legplates of heroism</option>
                <option value="legplates_of_the_qiraji_command">Legplates of the qiraji command</option>
                <option value="legplates_of_valor">Legplates of valor</option>
                <option value="r12_plate_legguards">R12 plate legguards</option>
                <option value="r8_plate_leggings">R8 plate leggings</option>
                <option value="scaled_sand_reaver_leggings">Scaled sand reaver leggings</option>
                <option value="titanic_leggings">Titanic leggings</option>
            </select>

            <p></p>

            <span class="left_select">boots</span><span class="middle_select">ring1</span><span class="right_select">ring2</span><br>
            <select id="boots_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="battlechasers_greaves">Battlechasers greaves</option>
                <option value="black_dragonscale_boots">Black dragonscale boots</option>
                <option value="blooddrenched_footpads">Blooddrenched footpads</option>
                <option value="bloodmail_boots">Bloodmail boots</option>
                <option value="boots_of_heroism">Boots of heroism</option>
                <option value="boots_of_the_fallen_hero">Boots of the fallen hero</option>
                <option value="boots_of_the_shadow_flame">Boots of the shadow flame</option>
                <option value="boots_of_the_vanguard">Boots of the vanguard</option>
                <option value="chromatic_boots">Chromatic boots</option>
                <option value="conquerors_greaves">Conquerors greaves</option>
                <option value="defilers_plate_greaves">Defilers plate greaves</option>
                <option value="r12_plate_boots">R12 plate boots</option>
                <option value="r7_greaves">R7 greaves</option>
                <option value="sapphirons_scale_boots">Sapphirons scale boots</option>
                <option value="slime_kickers">Slime kickers</option>
                <option value="windreaver_greaves">Windreaver greaves</option>
            </select>

            <select id="ring1_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="band_of_accuria">Band of accuria</option>
                <option value="band_of_earthen_might">Band of earthen might</option>
                <option value="band_of_jin">Band of jin</option>
                <option value="band_of_the_ogre_king">Band of the ogre king</option>
                <option value="blackstone_ring">Blackstone ring</option>
                <option value="circle_of_applied_force">Circle of applied force</option>
                <option value="don_julios_band">Don julios band</option>
                <option value="magnis_will">Magnis will</option>
                <option value="master_dragonslayers_ring">Master dragonslayers ring</option>
                <option value="might_of_cenarius">Might of cenarius</option>
                <option value="painweaver_band">Painweaver band</option>
                <option value="quick_strike_ring">Quick strike ring</option>
                <option value="ring_of_the_god_slayer">Ring of the god slayer</option>
                <option value="ring_of_the_qiraji_fury">Ring of the qiraji fury</option>
                <option value="seal_of_jin">Seal of jin</option>
                <option value="seal_of_the_gurubashi_berserker">Seal of the gurubashi berserker</option>
                <option value="signet_of_the_bronze_dragonflight">Signet of the bronze dragonflight</option>
                <option value="signet_of_unyielding_strength">Signet of unyielding strength</option>
                <option value="tarnished_elven_ring">Tarnished elven ring</option>
            </select>

            <select id="ring2_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="band_of_accuria">Band of accuria</option>
                <option value="band_of_earthen_might">Band of earthen might</option>
                <option value="band_of_jin">Band of jin</option>
                <option value="band_of_the_ogre_king">Band of the ogre king</option>
                <option value="blackstone_ring">Blackstone ring</option>
                <option value="circle_of_applied_force">Circle of applied force</option>
                <option value="don_julios_band">Don julios band</option>
                <option value="magnis_will">Magnis will</option>
                <option value="master_dragonslayers_ring">Master dragonslayers ring</option>
                <option value="might_of_cenarius">Might of cenarius</option>
                <option value="painweaver_band">Painweaver band</option>
                <option value="quick_strike_ring">Quick strike ring</option>
                <option value="ring_of_the_god_slayer">Ring of the god slayer</option>
                <option value="ring_of_the_qiraji_fury">Ring of the qiraji fury</option>
                <option value="seal_of_jin">Seal of jin</option>
                <option value="seal_of_the_gurubashi_berserker">Seal of the gurubashi berserker</option>
                <option value="signet_of_the_bronze_dragonflight">Signet of the bronze dragonflight</option>
                <option value="signet_of_unyielding_strength">Signet of unyielding strength</option>
                <option value="tarnished_elven_ring">Tarnished elven ring</option>
            </select>

            <p></p>

            <span class="left_select">trinket1</span><span class="middle_select">trinket2</span><span
                class="right_select">ranged</span><br>
            <select id="trinket1_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="badge_of_the_swarmguard">Badge of the swarmguard</option>
                <option value="blackhands_breadth">Blackhands breadth</option>
                <option value="counterattack_lodestone">Counterattack lodestone</option>
                <option value="darkmoon_card_maelstrom">Darkmoon card maelstrom</option>
                <option value="diamond_flask">Diamond flask</option>
                <option value="drake_fang_talisman">Drake fang talisman</option>
                <option value="earthstrike">Earthstrike</option>
                <option value="hand_of_justice">Hand of justice</option>
                <option value="jom_gabbar">Jom gabbar</option>
                <option value="rune_of_the_guard_captain">Rune of the guard captain</option>
            </select>

            <select id="trinket2_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="badge_of_the_swarmguard">Badge of the swarmguard</option>
                <option value="blackhands_breadth">Blackhands breadth</option>
                <option value="counterattack_lodestone">Counterattack lodestone</option>
                <option value="darkmoon_card_maelstrom">Darkmoon card maelstrom</option>
                <option value="diamond_flask">Diamond flask</option>
                <option value="drake_fang_talisman">Drake fang talisman</option>
                <option value="earthstrike">Earthstrike</option>
                <option value="hand_of_justice">Hand of justice</option>
                <option value="jom_gabbar">Jom gabbar</option>
                <option value="rune_of_the_guard_captain">Rune of the guard captain</option>
            </select>

            <select id="ranged_dd" class="item-select">
                <option value="none" selected disabled></option>
                <option value="blastershot">Blastershot</option>
                <option value="bloodseeker">Bloodseeker</option>
                <option value="crossbow_of_imminent_doom">Crossbow of imminent doom</option>
                <option value="dragonbreath_hand_cannon">Dragonbreath hand cannon</option>
                <option value="gurubashi_dwarf_destroyer">Gurubashi dwarf destroyer</option>
                <option value="heartstriker">Heartstriker</option>
                <option value="huhurans_stinger">Huhurans stinger</option>
                <option value="larvae_of_the_great_worm">Larvae of the great worm</option>
                <option value="precisely_calibrated_boomstick">Precisely calibrated boomstick</option>
                <option value="riphook">Riphook</option>
                <option value="satyrs_bow">Satyrs bow</option>
                <option value="strikers_mark">Strikers mark</option>
            </select>

            <p></p>

            <p class="select-title">Select weapons:</p><br>
            <select id="main_hand_dd" class="weapon-select">
                <option value="none" selected disabled></option>
                <option value="none" disabled> --- SWORDS ---</option>
                <option value="ancient_quiraji_ripper">Ancient quiraji ripper</option>
                <option value="assassination_blade">Assassination blade</option>
                <option value="blackguard">Blackguard</option>
                <option value="brutality_blade">Brutality blade</option>
                <option value="chromatically_tempered_sword">Chromatically tempered sword</option>
                <option value="dal_rends_sacred_charge">Dal rends sacred charge</option>
                <option value="maladath">Maladath</option>
                <option value="mirahs_song">Mirahs song</option>
                <option value="nightmare_blade">Nightmare blade</option>
                <option value="protectors_sword">Protectors sword</option>
                <option value="quel_serrar">Quel serrar</option>
                <option value="r14_longsword">R14 longsword</option>
                <option value="r14_swiftblade">R14 swiftblade</option>
                <option value="ravencrests_legacy">Ravencrests legacy</option>
                <option value="ravenholdt_slicer">Ravenholdt slicer</option>
                <option value="teebus_blazing_longsword">Teebus blazing longsword</option>
                <option value="thrash_blade">Thrash blade</option>
                <option value="thunderfury_blessed_blade">Thunderfury blessed blade</option>
                <option value="viskag">Viskag</option>
                <option value="warblade_hakkari_mh">Warblade hakkari mh</option>
                <option value="zulian_slicer">Zulian slicer</option>
                <option value="none" disabled> --- AXES ---</option>
                <option value="ancient_hakkari_manslayer">Ancient hakkari manslayer</option>
                <option value="axe_of_the_deep_woods">Axe of the deep woods</option>
                <option value="blessed_qiraji_war_axe">Blessed qiraji war axe</option>
                <option value="bone_slicing_hatchet">Bone slicing hatchet</option>
                <option value="crul_shorukh_edge_of_chaos">Crul shorukh edge of chaos</option>
                <option value="deathbringer">Deathbringer</option>
                <option value="dooms_edge">Dooms edge</option>
                <option value="flurry_axe">Flurry axe</option>
                <option value="frostbite">Frostbite</option>
                <option value="r14_handaxe">R14 handaxe</option>
                <option value="sickle_on_unyielding_strength">Sickle on unyielding strength</option>
                <option value="zulian_hacker_of_strength">Zulian hacker of strength</option>
                <option value="zulian_hacker_of_the_tiger">Zulian hacker of the tiger</option>
                <option value="none" disabled> --- DAGGERS ---</option>
                <option value="alcors_sunrazor">Alcors sunrazor</option>
                <option value="blessed_qiraji_pugio">Blessed qiraji pugio</option>
                <option value="core_hound_tooth">Core hound tooth</option>
                <option value="deaths_sting">Deaths sting</option>
                <option value="dragonfang_blade">Dragonfang blade</option>
                <option value="fang_of_the_faceless">Fang of the faceless</option>
                <option value="finkles_skinner">Finkles skinner</option>
                <option value="perditions_blade">Perditions blade</option>
                <option value="r14_dagger">R14 dagger</option>
                <option value="none" disabled> --- MACES ---</option>
                <option value="anubisath_warhammer">Anubisath warhammer</option>
                <option value="blessed_quiraji_warhammer">Blessed quiraji warhammer</option>
                <option value="ebon_hand">Ebon hand</option>
                <option value="empyrean_demolisher">Empyrean demolisher</option>
                <option value="ironfoe">Ironfoe</option>
                <option value="mass_of_mcgowan">Mass of mcgowan</option>
                <option value="persuader">Persuader</option>
                <option value="r14_mace">R14 mace</option>
                <option value="sand_polished_hammer">Sand polished hammer</option>
                <option value="sceptre_of_smiting">Sceptre of smiting</option>
                <option value="spineshatter">Spineshatter</option>
                <option value="stormstike_hammer">Stormstike hammer</option>
                <option value="none" disabled> --- FISTS ---</option>
                <option value="claw_of_the_black_drake">Claw of the black drake</option>
                <option value="silithid_claw">Silithid claw</option>
            </select>
            <select id="off_hand_dd" class="weapon-select">
                <option value="none" selected disabled></option>
                <option value="none" disabled> --- SWORDS ---</option>
                <option value="ancient_quiraji_ripper">Ancient quiraji ripper</option>
                <option value="assassination_blade">Assassination blade</option>
                <option value="blackguard">Blackguard</option>
                <option value="brutality_blade">Brutality blade</option>
                <option value="chromatically_tempered_sword">Chromatically tempered sword</option>
                <option value="dal_rends_tribal_guardian">Dal rends tribal guardian</option>
                <option value="maladath">Maladath</option>
                <option value="mirahs_song">Mirahs song</option>
                <option value="nightmare_blade">Nightmare blade</option>
                <option value="protectors_sword">Protectors sword</option>
                <option value="r14_longsword">R14 longsword</option>
                <option value="r14_swiftblade">R14 swiftblade</option>
                <option value="ravencrests_legacy">Ravencrests legacy</option>
                <option value="ravenholdt_slicer">Ravenholdt slicer</option>
                <option value="thrash_blade">Thrash blade</option>
                <option value="thunderfury_blessed_blade">Thunderfury blessed blade</option>
                <option value="viskag">Viskag</option>
                <option value="warblade_hakkari_oh">Warblade hakkari oh</option>
                <option value="zulian_slicer">Zulian slicer</option>
                <option value="none" disabled> --- AXES ---</option>
                <option value="ancient_hakkari_manslayer">Ancient hakkari manslayer</option>
                <option value="axe_of_the_deep_woods">Axe of the deep woods</option>
                <option value="blessed_qiraji_war_axe">Blessed qiraji war axe</option>
                <option value="bone_slicing_hatchet">Bone slicing hatchet</option>
                <option value="crul_shorukh_edge_of_chaos">Crul shorukh edge of chaos</option>
                <option value="deathbringer">Deathbringer</option>
                <option value="dooms_edge">Dooms edge</option>
                <option value="flurry_axe">Flurry axe</option>
                <option value="frostbite">Frostbite</option>
                <option value="r14_handaxe">R14 handaxe</option>
                <option value="sickle_on_unyielding_strength">Sickle on unyielding strength</option>
                <option value="zulian_hacker_of_strength">Zulian hacker of strength</option>
                <option value="zulian_hacker_of_the_tiger">Zulian hacker of the tiger</option>
                <option value="none" disabled> --- DAGGERS ---</option>
                <option value="alcors_sunrazor">Alcors sunrazor</option>
                <option value="blessed_qiraji_pugio">Blessed qiraji pugio</option>
                <option value="core_hound_tooth">Core hound tooth</option>
                <option value="deaths_sting">Deaths sting</option>
                <option value="dragonfang_blade">Dragonfang blade</option>
                <option value="fang_of_the_faceless">Fang of the faceless</option>
                <option value="perditions_blade">Perditions blade</option>
                <option value="r14_dagger">R14 dagger</option>
                <option value="none" disabled> --- MACES ---</option>
                <option value="anubisath_warhammer">Anubisath warhammer</option>
                <option value="blessed_quiraji_warhammer">Blessed quiraji warhammer</option>
                <option value="ebon_hand">Ebon hand</option>
                <option value="mass_of_mcgowan">Mass of mcgowan</option>
                <option value="r14_mace">R14 mace</option>
                <option value="sand_polished_hammer">Sand polished hammer</option>
                <option value="sceptre_of_smiting">Sceptre of smiting</option>
                <option value="stormstike_hammer">Stormstike hammer</option>
                <option value="none" disabled> --- FISTS ---</option>
            </select>
            <!--armor stop-->

        </div>
        <div id="armor_multiple" style="display:none">

            <p class="select-title">Quick-select:</p><br>
            <button onclick="load_p1prebisitems()">Example where phase 1 "pre-BiS" items are examined</button>
            <button onclick="load_p5pvebismult()">Load Phase 5 PvE-BiS</button>
            <br>
            Add/remove items: <b>ctrl + left-click</b>.<br>
            Add all items in a slot: Select an item box then press <b> ctrl + a</b>.<br><br>
            The optimization takes between: 1-"Max optimization time" seconds. <br>
            If you selected a lot of items leave it running in another tab<br><br>

            <!--armor begin2-->
            <span class="left_select">Helmet</span><span class="middle_select">Neck</span><span class="right_select">Shoulder</span><br>
            <select id="helmet_dd_mult" size="10" class="item-select" multiple>
                <option value="circlet_of_restless_dreams">Circlet of restless dreams</option>
                <option value="conquerors_crown">Conquerors crown</option>
                <option value="crown_of_destruction">Crown of destruction</option>
                <option value="expert_goldminers_head">Expert goldminers head</option>
                <option value="eye_of_rend">Eye of rend</option>
                <option value="fury_visor">Fury visor</option>
                <option value="helm_of_domination">Helm of domination</option>
                <option value="helm_of_endless_rage">Helm of endless rage</option>
                <option value="helm_of_heroism">Helm of heroism</option>
                <option value="helm_of_the_executioner">Helm of the executioner</option>
                <option value="helm_of_valor">Helm of valor</option>
                <option value="lionheart_helm">Lionheart helm</option>
                <option value="mask_of_the_unforgiven">Mask of the unforgiven</option>
                <option value="r10_commanders_plate_helm">R10 commanders plate helm</option>
                <option value="r13_plate_helm">R13 plate helm</option>
            </select>

            <select id="neck_dd_mult" size="10" class="item-select" multiple>
                <option value="amulet_of_the_darkmoon">Amulet of the darkmoon</option>
                <option value="barbed_choker">Barbed choker</option>
                <option value="beads_of_ogre_might">Beads of ogre might</option>
                <option value="choker_of_the_shifting_sands">Choker of the shifting sands</option>
                <option value="fury_of_the_forgotten_swarm">Fury of the forgotten swarm</option>
                <option value="imperial_jewel">Imperial jewel</option>
                <option value="mark_of_fordring">Mark of fordring</option>
                <option value="onyxia_tooth_pendant">Onyxia tooth pendant</option>
                <option value="prestors_talisman_of_connivery">Prestors talisman of connivery</option>
                <option value="the_eye_of_hakkar">The eye of hakkar</option>
            </select>

            <select id="shoulder_dd_mult" size="10" class="item-select" multiple>
                <option value="abyssal_plate_epaulets">Abyssal plate epaulets</option>
                <option value="black_dragonscale_shoulders">Black dragonscale shoulders</option>
                <option value="bloadsoaked_pauldrons">Bloadsoaked pauldrons</option>
                <option value="chitinous_shoulderguards">Chitinous shoulderguards</option>
                <option value="conquerors_spaulders">Conquerors spaulders</option>
                <option value="defilers_plate_spaulders">Defilers plate spaulders</option>
                <option value="drake_talon_pauldrons">Drake talon pauldrons</option>
                <option value="flamescarred_shoulders">Flamescarred shoulders</option>
                <option value="mantle_of_wicked_revenge">Mantle of wicked revenge</option>
                <option value="pauldrons_of_the_unrelenting">Pauldrons of the unrelenting</option>
                <option value="r10_commanders_plate_shoulders">R10 commanders plate shoulders</option>
                <option value="r13_plate_shoulderguards">R13 plate shoulderguards</option>
                <option value="razorsteel_shoulders">Razorsteel shoulders</option>
                <option value="spaulders_of_heroism">Spaulders of heroism</option>
                <option value="spaulders_of_valor">Spaulders of valor</option>
                <option value="truestrike_shoulders">Truestrike shoulders</option>
                <option value="wyrmhide_spaulders">Wyrmhide spaulders</option>
            </select>

            <p></p>

            <span class="left_select">Back</span><span class="middle_select">Chest</span><span class="right_select">Wrists</span><br>
            <select id="back_dd_mult" size="10" class="item-select" multiple>
                <option value="blackveil_cloak">Blackveil cloak</option>
                <option value="cape_of_the_black_baron">Cape of the black baron</option>
                <option value="cloak_of_concentrated_hate">Cloak of concentrated hate</option>
                <option value="cloak_of_draconic_might">Cloak of draconic might</option>
                <option value="cloak_of_firemaw">Cloak of firemaw</option>
                <option value="cloak_of_the_fallen_god">Cloak of the fallen god</option>
                <option value="cloak_of_the_golden_hive">Cloak of the golden hive</option>
                <option value="cloak_of_the_shrouded_mists">Cloak of the shrouded mists</option>
                <option value="deathguards_cloak">Deathguards cloak</option>
                <option value="drake_of_unyielding_strength">Drake of unyielding strength</option>
                <option value="puissant_cape">Puissant cape</option>
                <option value="stoneskin_gargoyle_cape">Stoneskin gargoyle cape</option>
                <option value="windshear_cape">Windshear cape</option>
                <option value="zulian_tigerhide_cloak">Zulian tigerhide cloak</option>
            </select>

            <select id="chest_dd_mult" size="10" class="item-select" multiple>
                <option value="black_dragonscale_chest">Black dragonscale chest</option>
                <option value="bloodsoul_breastplate">Bloodsoul breastplate</option>
                <option value="breastplate_of_annihilation">Breastplate of annihilation</option>
                <option value="breastplate_of_bloodthirst">Breastplate of bloodthirst</option>
                <option value="breastplate_of_heroism">Breastplate of heroism</option>
                <option value="breastplate_of_the_chromatic_flight">Breastplate of the chromatic flight</option>
                <option value="breastplate_of_valor">Breastplate of valor</option>
                <option value="cadaverous_armor">Cadaverous armor</option>
                <option value="conquerors_breastplate">Conquerors breastplate</option>
                <option value="deathdealer_breastplate">Deathdealer breastplate</option>
                <option value="malfurions_blessed_bulwark">Malfurions blessed bulwark</option>
                <option value="obsidian_mail_tunic">Obsidian mail tunic</option>
                <option value="ogre_forged_hauberk">Ogre forged hauberk</option>
                <option value="r13_plate_armor">R13 plate armor</option>
                <option value="r8_plate_hauberk">R8 plate hauberk</option>
                <option value="runed_bloodstaind_hauberk">Runed bloodstaind hauberk</option>
                <option value="savage_gladiator_chain">Savage gladiator chain</option>
                <option value="tombstone_breastplate">Tombstone breastplate</option>
                <option value="vest_of_swift_execution">Vest of swift execution</option>
                <option value="zandalar_vindicators_breastplate">Zandalar vindicators breastplate</option>
            </select>

            <select id="wrists_dd_mult" size="10" class="item-select" multiple>
                <option value="abyssal_plate_vambraces">Abyssal plate vambraces</option>
                <option value="battleborn_armbraces">Battleborn armbraces</option>
                <option value="berserker_bracers">Berserker bracers</option>
                <option value="blinkstrike">Blinkstrike</option>
                <option value="bracers_of_brutality">Bracers of brutality</option>
                <option value="bracers_of_heroism">Bracers of heroism</option>
                <option value="deeprock_bracers">Deeprock bracers</option>
                <option value="hive_defiler_wristguards">Hive defiler wristguards</option>
                <option value="quiraji_execution_bracers">Quiraji execution bracers</option>
                <option value="vambraces_of_the_sadist">Vambraces of the sadist</option>
                <option value="wristguards_of_stability">Wristguards of stability</option>
                <option value="wristhuards_of_true_flight">Wristhuards of true flight</option>
                <option value="zandalar_armguards">Zandalar armguards</option>
            </select>

            <p></p>

            <span class="left_select">Hands</span><span class="middle_select">Belt</span><span
                class="right_select">Legs</span><br>
            <select id="hands_dd_mult" size="10" class="item-select" multiple>
                <option value="aged_core_leather_gloves">Aged core leather gloves</option>
                <option value="bloodmail_gauntlets">Bloodmail gauntlets</option>
                <option value="devilsaur_gauntlets">Devilsaur gauntlets</option>
                <option value="edgemasters_handguards">Edgemasters handguards</option>
                <option value="flameguard_gauntlets">Flameguard gauntlets</option>
                <option value="gauntlets_of_annihilation">Gauntlets of annihilation</option>
                <option value="gauntlets_of_heroism">Gauntlets of heroism</option>
                <option value="gauntlets_of_might">Gauntlets of might</option>
                <option value="gauntlets_of_valor">Gauntlets of valor</option>
                <option value="gloves_of_enforcement">Gloves of enforcement</option>
                <option value="r12_plate_gauntlets">R12 plate gauntlets</option>
                <option value="r7_plate_gauntlets">R7 plate gauntlets</option>
                <option value="reiver_claws">Reiver claws</option>
                <option value="sacrificial_gauntlets">Sacrificial gauntlets</option>
            </select>

            <select id="belt_dd_mult" size="10" class="item-select" multiple>
                <option value="belt_of_heroism">Belt of heroism</option>
                <option value="belt_of_never_ending_agony">Belt of never ending agony</option>
                <option value="brigam_girdle">Brigam girdle</option>
                <option value="defilers_plate_girdle">Defilers plate girdle</option>
                <option value="frostwolf_plate_belt">Frostwolf plate belt</option>
                <option value="girdle_of_the_fallen_crusader">Girdle of the fallen crusader</option>
                <option value="mugglers_belt">Mugglers belt</option>
                <option value="omokks_girth_restrainer">Omokks girth restrainer</option>
                <option value="onslaught_girdle">Onslaught girdle</option>
                <option value="therazanes_link">Therazanes link</option>
                <option value="triad_girdle">Triad girdle</option>
                <option value="zandalar_vindicators_belt">Zandalar vindicators belt</option>
            </select>

            <select id="legs_dd_mult" size="10" class="item-select" multiple>
                <option value="abyssal_plate_legplates">Abyssal plate legplates</option>
                <option value="black_dragonscale_leggings">Black dragonscale leggings</option>
                <option value="blademaster_leggings">Blademaster leggings</option>
                <option value="bloodsoaked_legplates">Bloodsoaked legplates</option>
                <option value="cloudkeeper_legplates">Cloudkeeper legplates</option>
                <option value="cloudkeeper_legplates_no_use">Cloudkeeper legplates no use</option>
                <option value="conquerors_legguards">Conquerors legguards</option>
                <option value="dark_heart_pants">Dark heart pants</option>
                <option value="devilsaur_leggings">Devilsaur leggings</option>
                <option value="eldritch_legplates">Eldritch legplates</option>
                <option value="handcrafted_mastersmith_leggings">Handcrafted mastersmith leggings</option>
                <option value="legguards_of_the_fallen_crusader">Legguards of the fallen crusader</option>
                <option value="legplates_of_heroism">Legplates of heroism</option>
                <option value="legplates_of_the_qiraji_command">Legplates of the qiraji command</option>
                <option value="legplates_of_valor">Legplates of valor</option>
                <option value="r12_plate_legguards">R12 plate legguards</option>
                <option value="r8_plate_leggings">R8 plate leggings</option>
                <option value="scaled_sand_reaver_leggings">Scaled sand reaver leggings</option>
                <option value="titanic_leggings">Titanic leggings</option>
            </select>

            <p></p>

            <span class="left_select">Boots</span><span class="middle_select">Rings</span><span class="right_select">Trinkets</span><br>
            <select id="boots_dd_mult" size="10" class="item-select" multiple>
                <option value="battlechasers_greaves">Battlechasers greaves</option>
                <option value="black_dragonscale_boots">Black dragonscale boots</option>
                <option value="blooddrenched_footpads">Blooddrenched footpads</option>
                <option value="bloodmail_boots">Bloodmail boots</option>
                <option value="boots_of_heroism">Boots of heroism</option>
                <option value="boots_of_the_fallen_hero">Boots of the fallen hero</option>
                <option value="boots_of_the_shadow_flame">Boots of the shadow flame</option>
                <option value="boots_of_the_vanguard">Boots of the vanguard</option>
                <option value="chromatic_boots">Chromatic boots</option>
                <option value="conquerors_greaves">Conquerors greaves</option>
                <option value="defilers_plate_greaves">Defilers plate greaves</option>
                <option value="r12_plate_boots">R12 plate boots</option>
                <option value="r7_greaves">R7 greaves</option>
                <option value="sapphirons_scale_boots">Sapphirons scale boots</option>
                <option value="slime_kickers">Slime kickers</option>
                <option value="windreaver_greaves">Windreaver greaves</option>
            </select>

            <select id="ring_dd_mult" size="10" class="item-select" multiple>
                <option value="band_of_accuria">Band of accuria</option>
                <option value="band_of_earthen_might">Band of earthen might</option>
                <option value="band_of_jin">Band of jin</option>
                <option value="band_of_the_ogre_king">Band of the ogre king</option>
                <option value="blackstone_ring">Blackstone ring</option>
                <option value="circle_of_applied_force">Circle of applied force</option>
                <option value="don_julios_band">Don julios band</option>
                <option value="magnis_will">Magnis will</option>
                <option value="master_dragonslayers_ring">Master dragonslayers ring</option>
                <option value="might_of_cenarius">Might of cenarius</option>
                <option value="painweaver_band">Painweaver band</option>
                <option value="quick_strike_ring">Quick strike ring</option>
                <option value="ring_of_the_god_slayer">Ring of the god slayer</option>
                <option value="ring_of_the_qiraji_fury">Ring of the qiraji fury</option>
                <option value="seal_of_jin">Seal of jin</option>
                <option value="seal_of_the_gurubashi_berserker">Seal of the gurubashi berserker</option>
                <option value="signet_of_the_bronze_dragonflight">Signet of the bronze dragonflight</option>
                <option value="signet_of_unyielding_strength">Signet of unyielding strength</option>
                <option value="tarnished_elven_ring">Tarnished elven ring</option>
            </select>

            <select id="trinket_dd_mult" size="10" class="item-select" multiple>
                <option value="badge_of_the_swarmguard">Badge of the swarmguard</option>
                <option value="blackhands_breadth">Blackhands breadth</option>
                <option value="counterattack_lodestone">Counterattack lodestone</option>
                <option value="darkmoon_card_maelstrom">Darkmoon card maelstrom</option>
                <option value="diamond_flask">Diamond flask</option>
                <option value="drake_fang_talisman">Drake fang talisman</option>
                <option value="earthstrike">Earthstrike</option>
                <option value="hand_of_justice">Hand of justice</option>
                <option value="jom_gabbar">Jom gabbar</option>
                <option value="rune_of_the_guard_captain">Rune of the guard captain</option>
            </select>

            <p></p>

            <span class="left_select">Ranged</span><span class="middle_select">Weapons</span><br>
            <select id="ranged_dd_mult" size="10" class="item-select" multiple>
                <option value="blastershot">Blastershot</option>
                <option value="bloodseeker">Bloodseeker</option>
                <option value="crossbow_of_imminent_doom">Crossbow of imminent doom</option>
                <option value="dragonbreath_hand_cannon">Dragonbreath hand cannon</option>
                <option value="gurubashi_dwarf_destroyer">Gurubashi dwarf destroyer</option>
                <option value="heartstriker">Heartstriker</option>
                <option value="huhurans_stinger">Huhurans stinger</option>
                <option value="larvae_of_the_great_worm">Larvae of the great worm</option>
                <option value="precisely_calibrated_boomstick">Precisely calibrated boomstick</option>
                <option value="riphook">Riphook</option>
                <option value="satyrs_bow">Satyrs bow</option>
                <option value="strikers_mark">Strikers mark</option>
            </select>

            <select id="weapons_dd_mult" size="10" class="item-select" multiple>
                <option value="none" disabled> --- SWORDS ---</option>
                <option value="ancient_quiraji_ripper">Ancient quiraji ripper</option>
                <option value="assassination_blade">Assassination blade</option>
                <option value="blackguard">Blackguard</option>
                <option value="brutality_blade">Brutality blade</option>
                <option value="chromatically_tempered_sword">Chromatically tempered sword</option>
                <option value="dal_rends_sacred_charge">Dal rends sacred charge</option>
                <option value="dal_rends_tribal_guardian">Dal rends tribal guardian</option>
                <option value="maladath">Maladath</option>
                <option value="mirahs_song">Mirahs song</option>
                <option value="nightmare_blade">Nightmare blade</option>
                <option value="protectors_sword">Protectors sword</option>
                <option value="quel_serrar">Quel serrar</option>
                <option value="r14_longsword">R14 longsword</option>
                <option value="r14_swiftblade">R14 swiftblade</option>
                <option value="ravencrests_legacy">Ravencrests legacy</option>
                <option value="ravenholdt_slicer">Ravenholdt slicer</option>
                <option value="teebus_blazing_longsword">Teebus blazing longsword</option>
                <option value="thrash_blade">Thrash blade</option>
                <option value="thunderfury_blessed_blade">Thunderfury blessed blade</option>
                <option value="viskag">Viskag</option>
                <option value="warblade_hakkari_mh">Warblade hakkari mh</option>
                <option value="warblade_hakkari_oh">Warblade hakkari oh</option>
                <option value="zulian_slicer">Zulian slicer</option>
                <option value="none" disabled> --- AXES ---</option>
                <option value="ancient_hakkari_manslayer">Ancient hakkari manslayer</option>
                <option value="axe_of_the_deep_woods">Axe of the deep woods</option>
                <option value="blessed_qiraji_war_axe">Blessed qiraji war axe</option>
                <option value="bone_slicing_hatchet">Bone slicing hatchet</option>
                <option value="crul_shorukh_edge_of_chaos">Crul shorukh edge of chaos</option>
                <option value="deathbringer">Deathbringer</option>
                <option value="dooms_edge">Dooms edge</option>
                <option value="flurry_axe">Flurry axe</option>
                <option value="frostbite">Frostbite</option>
                <option value="r14_handaxe">R14 handaxe</option>
                <option value="sickle_on_unyielding_strength">Sickle on unyielding strength</option>
                <option value="zulian_hacker_of_strength">Zulian hacker of strength</option>
                <option value="zulian_hacker_of_the_tiger">Zulian hacker of the tiger</option>
                <option value="none" disabled> --- DAGGERS ---</option>
                <option value="alcors_sunrazor">Alcors sunrazor</option>
                <option value="blessed_qiraji_pugio">Blessed qiraji pugio</option>
                <option value="core_hound_tooth">Core hound tooth</option>
                <option value="deaths_sting">Deaths sting</option>
                <option value="dragonfang_blade">Dragonfang blade</option>
                <option value="fang_of_the_faceless">Fang of the faceless</option>
                <option value="finkles_skinner">Finkles skinner</option>
                <option value="perditions_blade">Perditions blade</option>
                <option value="r14_dagger">R14 dagger</option>
                <option value="none" disabled> --- MACES ---</option>
                <option value="anubisath_warhammer">Anubisath warhammer</option>
                <option value="blessed_quiraji_warhammer">Blessed quiraji warhammer</option>
                <option value="ebon_hand">Ebon hand</option>
                <option value="empyrean_demolisher">Empyrean demolisher</option>
                <option value="ironfoe">Ironfoe</option>
                <option value="mass_of_mcgowan">Mass of mcgowan</option>
                <option value="persuader">Persuader</option>
                <option value="r14_mace">R14 mace</option>
                <option value="sand_polished_hammer">Sand polished hammer</option>
                <option value="sceptre_of_smiting">Sceptre of smiting</option>
                <option value="spineshatter">Spineshatter</option>
                <option value="stormstike_hammer">Stormstike hammer</option>
                <option value="none" disabled> --- FISTS ---</option>
                <option value="claw_of_the_black_drake">Claw of the black drake</option>
                <option value="silithid_claw">Silithid claw</option>
            </select>
            <!--armor stop2-->

        </div>
        <br><br>

        <p class="select-title">Select mode:</p><br>
        <input type="checkbox" id="normal_mode" checked
               onclick="unique_checkboxes('normal_mode', ['multiple_mode', 'do_comparison']);
                        unique_div(['armor_single', 'standard_description_div'],['armor_multiple', 'compare_div', 'multi_description_div'])">
        <label for="normal_mode"> <b>Standard</b>: Simulate an item configuration </label><br>
        <div class="description" id="standard_description_div">
            <input type="checkbox" id="item_strengths">
            <label for="item_strengths">Suggest item upgrades for each slot. Will be displayed in the results
                section</label>
        </div>
        <br>

        <input type="checkbox" id="multiple_mode"
               onclick="unique_checkboxes('multiple_mode', ['normal_mode', 'do_comparison']);
                        unique_div(['armor_multiple', 'multi_description_div'],['armor_single','standard_description_div', 'compare_div'])">
        <label for="multiple_mode"><b>Multi-mode</b>: Enable selection of multiple items from the same slot.</label><br>
        <div class="description" style="display:none" id="multi_description_div">
            <b>Information:</b> More items selected means that the optimizer will run for a longer time. It will break
            automatically when it has found the best set <b>OR</b> when the max optimization timer is reached.<br>
            <label for="max_optimize_time">Max optimization time: (60-120s):</label>
            <input type="number" id="max_optimize_time" name="quantity" min="60" max="180" value="90"> seconds.<br/>
            <input type="checkbox" id="display_multi_debug">
            <label for="display_multi_debug">Output debug information from the optimizer (shown at the
                bottom)</label>
        </div>
        <br>

        <input type="checkbox" id="do_comparison"
               onclick="unique_checkboxes('do_comparison', ['multiple_mode', 'normal_mode']);
                        unique_div(['compare_div', 'armor_single'],['armor_multiple', 'multi_description_div'])">
        <label for="do_comparison"><b>Comparison</b>: Add a configuration file to compare against</label>
        <div class="description" style="display:none" id="compare_div">
            <b>Description:</b> Select an item config and press submit.<br/>
            (To generate a config file press "Save config to file" at the top of the page)<br/>
            <input type="file" id="myCompareFile" name="filename" accept=".txt" onclick="show_div('compare_div')">
            <input type="submit" onclick="load_compare_data()">
        </div>
        <br/>
    </div>
    <br><br>

    <button type="button" class="collapsible">Race and Enchants</button>
    <div class="content">
        <p class="select-title">Select race:</p><br>
        <select id="race_dd">
            <option value="human">human</option>
            <option value="gnome">gnome</option>
            <option value="dwarf">dwarf</option>
            <option value="night_elf">night_elf</option>
            <option value="orc">orc</option>
            <option value="troll">troll</option>
            <option value="undead">undead</option>
            <option value="tauren">tauren</option>
        </select><br><br>

        <p class="select-title">Select enchants:</p><br>
        <!--    Helmet <span style="padding-left:20px">-->
        <select id="helmet_ench_dd" class="enchant-select">
            <option value="helmet">helmet</option>
            <option value="+8 strength">+8 strength</option>
            <option value="+1 haste">+1 haste</option>
        </select>

        <select id="shoulder_ench_dd" class="enchant-select">
            <option value="shoulder">shoulder</option>
            <option value="+30 attack_power">+30 attack power</option>
        </select>

        <select id="back_ench_dd" class="enchant-select">
            <option value="back">back</option>
            <option value="+3 agility">+3 agility</option>
        </select>

        <select id="chest_ench_dd" class="enchant-select">
            <option value="back">chest</option>
            <option value="+3 stats">+3 stats</option>
            <option value="+4 stats">+4 stats</option>
        </select>

        <p></p>

        <select id="wrist_ench_dd" class="enchant-select">
            <option value="wrist">wrist</option>
            <option value="+7 strength">+7 strength</option>
            <option value="+9 strength">+9 strength</option>
        </select>

        <select id="hands_ench_dd" class="enchant-select">
            <option value="hands">hands</option>
            <option value="+7 agility">+7 agility</option>
            <option value="+15 agility">+15 agility</option>
            <option value="+7 strength">+7 strength</option>
            <option value="+1 haste">+1 haste</option>
        </select>

        <select id="legs_ench_dd" class="enchant-select">
            <option value="legs">legs</option>
            <option value="+8 strength">+8 strength</option>
            <option value="+1 haste">+1 haste</option>
        </select>

        <select id="boots_ench_dd" class="enchant-select">
            <option value="boots">boots</option>
            <option value="+7 agility">+7 agility</option>
            <option value="minor speed">minor speed</option>
        </select>

        <p></p>

        <select id="main_hand_ench_dd" class="enchant-select">
            <option value="main_hand">weapon</option>
            <option value="crusader">crusader</option>
        </select>

        <select id="off_hand_ench_dd" class="enchant-select">
            <option value="off_hand">off_hand</option>
            <option value="crusader">crusader</option>
        </select>
    </div>
    <br><br>

    <button type="button" class="collapsible">Open Buffs and Consumables</button>
    <div class="content">
        <p class="select-title">World buffs:</p><br>
        <input type="checkbox" id="rallying_cry" checked>
        <label for="rallying_cry"> Rallying Cry of the Dragon Slayer</label><br>

        <input type="checkbox" id="dire_maul" checked>
        <label for="dire_maul"> Fengus' Ferocity</label><br>

        <input type="checkbox" id="songflower">
        <label for="songflower"> Songflower Serenade</label><br>

        <input type="checkbox" id="warchiefs_blessing">
        <label for="warchiefs_blessing"> Warchiefs Blessing</label><br>

        <input type="checkbox" id="spirit_of_zandalar" checked>
        <label for="spirit_of_zandalar"> Spirit of Zandalar</label><br>

        <input type="checkbox" id="sayges_fortune">
        <label for="sayges_fortune"> Sayges Fortune</label><br><br>

        <b> Player buffs:</b><br>
        <input type="checkbox" id="battle_shout" checked>
        <label for="battle_shout"> Battle Shout</label><br>

        <input type="checkbox" id="gift_of_the_wild" checked>
        <label for="gift_of_the_wild"> Gift of the Wild</label><br>

        <input type="checkbox" id="leader_of_the_pack">
        <label for="leader_of_the_pack"> Leader of the Pack</label><br>

        <input type="checkbox" id="trueshot_aura" checked>
        <label for="trueshot_aura"> Treushot aura</label><br>

        <input type="checkbox" id="blessing_of_kings" checked>
        <label for="blessing_of_kings" style="color: #003d99"> Blessing of Kings</label><br>

        <input type="checkbox" id="blessing_of_might" checked>
        <label for="blessing_of_might" style="color: #003d99"> Blessing of Might</label><br>

        <input type="checkbox" id="windfury_totem">
        <label for="windfury_totem" style="color: #cc0000"> Windfury totem</label><br>

        <input type="checkbox" id="strength_of_earth_totem">
        <label for="strength_of_earth_totem" style="color: #cc0000"> Strength of earth Totem</label><br>

        <input type="checkbox" id="grace_of_air_totem">
        <label for="grace_of_air_totem" style="color: #cc0000"> Grace of Air Totem</label><br><br>

        <b> AQ-books:</b><br>
        <input type="checkbox" id="battle_shout_aq" checked>
        <label for="battle_shout_aq"> Battle shout AQ-book</label><br>

        <input type="checkbox" id="blessing_of_might_aq" checked>
        <label for="blessing_of_might_aq" style="color: #003d99"> Blessing of Might AQ-book</label><br>

        <input type="checkbox" id="heroic_strike_aq" checked>
        <label for="heroic_strike_aq"> Heroic Strike AQ-book</label><br><br>

        <b> Consumables:</b><br>
        <input type="checkbox" id="elixir_mongoose" checked>
        <label for="elixir_mongoose"> Elixir of the Mongoose</label><br>

        <input type="checkbox" id="blessed_sunfruit" onclick=
                "if (document.getElementById('smoked_dessert_dumplings').checked)
                {
                    document.getElementById('smoked_dessert_dumplings').checked = false;
                }" checked>
        <label for="blessed_sunfruit"> Blessed Sunfruit</label><br>

        <input type="checkbox" id="smoked_dessert_dumplings" onclick=
                "if (document.getElementById('blessed_sunfruit').checked)
                {
                    document.getElementById('blessed_sunfruit').checked = false;
                }">
        <label for="smoked_dessert_dumplings"> Smoked Dessert Dumplings</label><br>

        <input type="checkbox" id="juju_might" onclick=
                "if (document.getElementById('winterfall_firewater').checked)
                {
                    document.getElementById('winterfall_firewater').checked = false;
                }">
        <label for="juju_might"> Juju Might</label><br>

        <input type="checkbox" id="winterfall_firewater" onclick=
                "if (document.getElementById('juju_might').checked)
                {
                    document.getElementById('juju_might').checked = false;
                }">
        <label for="winterfall_firewater"> Winterfall Firewater</label><br>

        <input type="checkbox" id="juju_power" onclick=
                "if (document.getElementById('elixir_of_giants').checked)
                {
                    document.getElementById('elixir_of_giants').checked = false;
                }" checked>
        <label for="juju_power"> Juju Power</label><br>

        <input type="checkbox" id="elixir_of_giants" onclick=
                "if (document.getElementById('juju_power').checked)
                {
                    document.getElementById('juju_power').checked = false;
                }">
        <label for="elixir_of_giants"> Elixir of Giants</label><br>

        <input type="checkbox" id="roids" checked>
        <label for="roids"> R.O.I.D.S</label><br><br>

        <b> Stones:</b><br>
        <input type="checkbox" id="dense_stone_main_hand" onclick=
                "if (document.getElementById('elemental_stone_main_hand').checked)
                {
                    document.getElementById('elemental_stone_main_hand').checked = false;
                }" checked>
        <label for="dense_stone_main_hand"> Dense Stone Main Hand</label><br>

        <input type="checkbox" id="elemental_stone_main_hand" onclick=
                "if (document.getElementById('dense_stone_main_hand').checked)
                {
                    document.getElementById('dense_stone_main_hand').checked = false;
                }">
        <label for="elemental_stone_main_hand"> Elemental Stone Main Hand</label><br>

        <input type="checkbox" id="dense_stone_off_hand" onclick=
                "if (document.getElementById('elemental_stone_off_hand').checked)
                {
                    document.getElementById('elemental_stone_off_hand').checked = false;
                }" checked>
        <label for="dense_stone_off_hand"> Dense Stone Main Hand</label><br>

        <input type="checkbox" id="elemental_stone_off_hand" onclick=
                "if (document.getElementById('dense_stone_off_hand').checked)
                {
                    document.getElementById('dense_stone_off_hand').checked = false;
                }">
        <label for="elemental_stone_off_hand"> Elemental Stone Main Hand</label>
    </div>
    <br/><br/>

    <button type="button" class="collapsible">Open combat settings</button>
    <div class="content">
        <b>Cooldowns:</b><br/>
        <input type="checkbox" id="death_wish" checked>
        <label for="death_wish"> Use death wish (used in the last 30sec)</label><br>
        <input type="checkbox" id="mighty_rage_potion">
        <label for="mighty_rage_potion"> Use mighty rage potion (used in the last 25sec)</label><br>
        <input type="checkbox" id="recklessness">
        <label for="recklessness"> Use recklessness (used in the last 20sec)</label><br><br/>

        <b>Armor reduction:</b><br/>
        The target is a "warrior" type monster with 3731 armor. <br/>
        <label for="sunder_armor_dd">Sunder armor stacks: (0-5):</label>
        <input type="number" id="sunder_armor_dd" name="quantity" min="0" max="5" value="5"><br/>
        <input type="checkbox" id="exposed_armor">
        <label for="exposed_armor"> Improved exposed armor applied after 6-7 seconds (replaces sunder armor)</label><br>
        <input type="checkbox" id="faerie_fire" checked>
        <label for="faerie_fire"> Faerie fire feral active</label><br>
        <input type="checkbox" id="curse_of_recklessness" checked>
        <label for="curse_of_recklessness"> Curse of recklessness active</label><br><br/>

        <b>Combat strategy:</b><br/>
        <input type="checkbox" id="use_bt_in_exec_phase">
        <label for="use_bt_in_exec_phase"> Use bloodthirst in execute phase</label><br>
        <input type="checkbox" id="use_hs_in_exec_phase" checked>
        <label for="use_hs_in_exec_phase"> Use heroic strike in execute phase</label><br>
        <label for="initial_rage">Initial rage when fight starts:</label>
        <input type="number" id="initial_rage" name="quantity" min="0" max="100" value="0.0"><br/>
        <label for="heroic_strike_rage_thresh_dd">Heroic strike when rage is above:</label>
        <input type="number" id="heroic_strike_rage_thresh_dd" name="quantity" min="0" max="100" value="50"><br>
        <label for="whirlwind_rage_thresh_dd">Whirlwind when rage is above:</label>
        <input type="number" id="whirlwind_rage_thresh_dd" name="quantity" min="0" max="100" value="0"><br>
        <label for="whirlwind_bt_cooldown_thresh_dd">Whirlwind when bloodthirst CD is above:</label>
        <input type="number" id="whirlwind_bt_cooldown_thresh_dd" name="quantity" min="0" max="6" value="1.5"><br>

        <input type="checkbox" id="cleave_if_adds" checked>
        <label for="cleave_if_adds"> Use cleave if there are more than one target.</label><br>
        <label for="cleave_rage_thresh_dd">Cleave when rage is above:</label>
        <input type="number" id="cleave_rage_thresh_dd" name="quantity" min="0" max="100" value="50"><br>

        <input type="checkbox" id="use_hamstring">
        <label for="use_hamstring"> Use hamstring</label><br>
        <label for="hamstring_cd_thresh_dd">Hamstring when bloodthirst/Whirlwind CD is above:</label>
        <input type="number" id="hamstring_cd_thresh_dd" name="quantity" min="0" max="6" value="2.0"><br>
        <label for="hamstring_thresh_dd">Hamstring when rage is above:</label>
        <input type="number" id="hamstring_thresh_dd" name="quantity" min="0" max="100" value="70"><br><br>

        <b>Boss settings:</b><br/>
        <b>Default:</b><br/>
        <input type="checkbox" id="default_boss" checked onclick="unique_checkboxes('default_boss',
        ['sulfuron_harbinger', 'golemagg', 'vaelastrasz'])">
        <label for="default_boss"> Fight against a single target with 100% combat uptime. </label><br>
        <b>Molten core:</b><br/>
        <input type="checkbox" id="sulfuron_harbinger" onclick="unique_checkboxes('sulfuron_harbinger',
        ['default_boss', 'golemagg', 'vaelastrasz'])">
        <label for="sulfuron_harbinger"> Fight against Sulfuron Harbinger (Four adds in melee cleave range before
            boss)</label><br>
        <input type="checkbox" id="golemagg" onclick="unique_checkboxes('golemagg',
        ['default_boss', 'sulfuron_harbinger', 'vaelastrasz'])">
        <label for="golemagg"> Fight against Golemagg (Two adds in melee cleave range during the fight)</label><br>
        <b>Black wing lair:</b><br/>
        <input type="checkbox" id="vaelastrasz" onclick="unique_checkboxes('vaelastrasz',
        ['default_boss', 'sulfuron_harbinger', 'golemagg'])">
        <label for="vaelastrasz"> Fight against Vaelastrasz (essence of the red + initial boss HP =
            30%)</label><br/>
        <input type="checkbox" id="chromaggus" disabled>
        <label for="chromaggus"> Fight against Chromaggus (Coming soon)</label><br>
        <input type="checkbox" id="firemaw" disabled>
        <label for="firemaw"> Fight against Firemaw (Coming soon)</label><br>
    </div>
    <br/><br/>

    <button type="button" class="collapsible">Open simulation settings</button>
    <div class="content">
        <label for="n_simulations_dd">Number of simulations (DPS): (1 - 1.000.000):</label>
        <input type="number" id="n_simulations_dd" name="quantity" min="1" max="1000000" value="50000"><br/>
        <label for="n_simulations_stat_dd">Number of simulations (per stat weight): (1 - 50.000):</label>
        <input type="number" id="n_simulations_stat_dd" name="quantity" min="1" max="1000000" value="20000"><br/>
        <label for="opponent_level_dd">Opponent level: (60-63):</label>
        <input type="number" id="opponent_level_dd" name="quantity" min="60" max="63" value="63"><br/>
        <label for="fight_time_dd">Fight duration: (10-120s):</label>
        <input type="number" id="fight_time_dd" name="quantity" min="10" max="300" value="60"><br/>
        <input type="checkbox" id="deep_wounds">
        <label for="deep_wounds"> Enable deep wounds.</label><br><br/>

        <b>Stat weights (each stat weight adds extra simulations):</b><br/>
        <input type="checkbox" id="stat_weight_crit" checked>
        <label for="stat_weight_crit"> Calculate stat weight for &plusmn1% crit.</label><br>

        <input type="checkbox" id="stat_weight_hit" checked>
        <label for="stat_weight_hit"> Calculate stat weight for &plusmn1% hit.</label><br>

        <input type="checkbox" id="stat_weight_haste">
        <label for="stat_weight_haste"> Calculate stat weight for &plusmn1% haste.</label><br>

        <input type="checkbox" id="stat_weight_extra_hit">
        <label for="stat_weight_extra_hit"> Calculate stat weight for +1% extra hit.</label><br>

        <input type="checkbox" id="stat_weight_skill">
        <label for="stat_weight_skill"> Calculate stat weight for &plusmn5 skill.</label><br><br>

        <b>Debug:</b><br/>
        <input type="checkbox" id="debug_on">
        <label for="debug_on"> Display combat debug information for the median fight.</label><br>
    </div>

    <p></p>
    <button style="width: 400px; height: 60px;" class="run_sim_button" data-item-name="itemname">Run simulator
    </button>

    <h2>----------- RESULTS BELOW -----------</h2>
    <div id="loader">
        <div>
        </div>
    </div>

    <p id="output1"></p>

    <p id="output2"></p>

    <p id="output3"></p>

    <p id="output4"></p>

    <p id="combat_debug_title"></p>
    <div id="combat_debug" class="scroll" hidden>
        <div>
        </div>
    </div>

    <canvas id="line-chart-hist"></canvas>

    <p></p>
    <canvas id="line-chart-fight"></canvas>

    <p></p>
    <canvas id="line-chart-fight-cumulative"></canvas>

    <p></p>
    <canvas id="bar-chart-damage"></canvas>

    <p></p>
    <canvas id="bar-chart-auras"></canvas>

    <p></p>
    <canvas id="bar-chart-proc"></canvas>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

<!--<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">-->
<!--<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.css">-->
<!--<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/milligram/1.3.0/milligram.css">-->

<!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/picnic">-->

<script>
    function show_div(box) {
        let vis = "none";
        if (document.getElementById("do_comparison").checked) {
            vis = "block";
        }
        document.getElementById(box).style.display = vis;
    }

    function unique_checkboxes(clicked_box, list_of_boxes) {
        for (let box of list_of_boxes) {
            if (document.getElementById(box).checked) {
                document.getElementById(box).checked = false;
            }
        }
        document.getElementById(clicked_box).checked = true;
    }

    function unique_div(divs_to_show, divs_to_hide) {
        for (let div_to_show of divs_to_show) {
            document.getElementById(div_to_show).style.display = "block";
        }
        for (let div_to_hide of divs_to_hide) {
            document.getElementById(div_to_hide).style.display = "none";
        }
    }

    function unique_checkboxes_a(clicked_box, list_of_boxes) {
        for (let box of list_of_boxes) {
            if (document.getElementById(box).checked) {
                document.getElementById(box).checked = false;
            }
        }
        document.getElementById(clicked_box).checked = true;
    }

    var coll = document.getElementsByClassName("collapsible");

    for (let i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function () {
            this.classList.toggle("active");
            let content = this.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
            for (let j = 0; j < coll.length; j++) {
                if (coll[j] !== this) {
                    let other_content = coll[j].nextElementSibling;
                    other_content.style.display = "none";
                }
            }
        });
    }

    function open_armor() {
        document.getElementById("armor_n_wep").click();
        // armor_wep_div.style.display = "block";
    }

    var world_buffs = ["rallying_cry", "dire_maul", "songflower", "warchiefs_blessing", "spirit_of_zandalar", "sayges_fortune"];
    var world_buffs_input = [];

    var buffs = ["battle_shout", "blessing_of_kings", "blessing_of_might", "gift_of_the_wild", "leader_of_the_pack", "trueshot_aura",
        "windfury_totem", "strength_of_earth_totem", "grace_of_air_totem"];
    var buffs_input = [];

    var consumables = ["elixir_mongoose", "blessed_sunfruit", "smoked_dessert_dumplings", "juju_power", "elixir_of_giants", "winterfall_firewater",
        "juju_might", "roids", "dense_stone_main_hand", "elemental_stone_main_hand", "dense_stone_off_hand", "elemental_stone_off_hand",
        "battle_shout_aq", "blessing_of_might_aq"];
    var consumables_input = [];

    var armor = ["helmet_dd", "neck_dd", "shoulder_dd", "back_dd",
        "chest_dd", "wrists_dd", "hands_dd", "belt_dd", "legs_dd",
        "boots_dd", "ring1_dd", "ring2_dd", "trinket1_dd", "trinket2_dd", "ranged_dd"];
    var armor_input = [];

    var weapons = ["main_hand_dd", "off_hand_dd"];
    var weapons_input = [];

    var armor_mult = ["helmet_dd_mult", "neck_dd_mult", "shoulder_dd_mult", "back_dd_mult",
        "chest_dd_mult", "wrists_dd_mult", "hands_dd_mult", "belt_dd_mult", "legs_dd_mult",
        "boots_dd_mult", "ring_dd_mult", "trinket_dd_mult", "ranged_dd_mult"];
    var armor_input_mult = [];

    var weapons_mult = ["weapons_dd_mult"];
    var weapons_input_mult = [];

    var enchants = ["helmet_ench_dd", "shoulder_ench_dd", "back_ench_dd", "chest_ench_dd", "wrist_ench_dd",
        "hands_ench_dd", "legs_ench_dd", "boots_ench_dd", "main_hand_ench_dd", "off_hand_ench_dd"];
    var enchant_prefixes = ["e", "s", "b", "c", "w", "h", "l", "b", "m", "o"];
    var enchants_input = [];

    var sim_options = ["faerie_fire", "exposed_armor", "curse_of_recklessness", "death_wish",
        "recklessness", "mighty_rage_potion", "default_boss", "sulfuron_harbinger", "golemagg", "vaelastrasz",
        "chromaggus", "debug_on", "use_bt_in_exec_phase", "use_hs_in_exec_phase", "cleave_if_adds",
        "hamstring_cd_thresh_dd", "hamstring_thresh_dd", "initial_rage", "use_hamstring", "item_strengths",
        "deep_wounds", "heroic_strike_aq"];

    var stat_weigths = ["stat_weight_hit", "stat_weight_crit", "stat_weight_haste",
        "stat_weight_extra_hit", "stat_weight_skill"];

    var race;
    var race_string;

    function string_is_armor(string) {
        for (let armor_string of armor) {
            if (string === armor_string) {
                return true;
            }
        }
        return false;
    }

    function string_is_weapon(string) {
        for (let weapon_string of weapons) {
            if (string === weapon_string) {
                return true;
            }
        }
        return false;
    }

    var compare_armor_input = [];
    var compare_weapons_input = [];

    function load_compare_data() {
        let file = document.getElementById("myCompareFile");
        let myFile = file.files[0];
        if (myFile !== undefined) {
            let reader = new FileReader();
            reader.readAsText(myFile);
            reader.onload = function () {
                compare_armor_input = [];
                compare_weapons_input = [];
                let rawLog = reader.result;
                let splitlog = rawLog.split("\n");
                for (let item of splitlog) {
                    let dd_name = item.split(" ");
                    if (string_is_armor(dd_name[0])) {
                        compare_armor_input.push(dd_name[1]);
                    } else if (string_is_weapon(dd_name[0])) {
                        compare_weapons_input.push(dd_name[1]);
                    }
                }
                // console.log(compare_armor_input);
            }
        }
    }

    function load_file() {
        let file = document.getElementById("myFile");
        var myFile = file.files[0];
        var reader = new FileReader();

        //set all buff-values to unchecked before loading
        for (let world_buff of world_buffs) {
            document.getElementById(world_buff).checked = false;
        }
        for (let buff of buffs) {
            document.getElementById(buff).checked = false;
        }
        for (let consumable of consumables) {
            document.getElementById(consumable).checked = false;
        }
        for (let consumable of stat_weigths) {
            document.getElementById(consumable).checked = false;
        }
        for (let consumable of sim_options) {
            document.getElementById(consumable).checked = false;
        }
        // for (let consumable of ar) {
        //     document.getElementById(consumable).checked = false;
        // }

        reader.readAsText(myFile);
        reader.onload = function () {
            let rawLog = reader.result;
            let splitlog = rawLog.split("\n");
            for (let item of splitlog) {
                let dd_name = item.split(" ");
                // console.log(dd_name[0]);
                if (dd_name.length === 2) {
                    // console.log(dd_name[1]);
                    selectElement(dd_name[0], dd_name[1])
                } else {
                    // console.log(dd_name[1] + " " + dd_name[2]);
                    selectElement(dd_name[0], dd_name[1] + " " + dd_name[2])
                }
            }
        }
    }

    function selectElement(id, valueToSelect) {
        if (id !== "" && id !== "undefined") {
            if (id.slice(id.length - 2, id.length) === "dd" ||
                id.slice(id.length - 4, id.length) === "mult") {
                try {
                    document.getElementById(id).value = valueToSelect;
                } catch (err) {
                    console.log(err);
                }
            } else {
                if (id === valueToSelect) {
                    try {
                        document.getElementById(id).checked = true;
                    } catch (err) {
                        console.log(err);
                    }
                }
            }
        }
    }

    function select_prebis(selected_items, selected_weapons, selected_enchants) {
        for (let i = 0; i < armor.length; i++) {
            selectElement(armor[i], selected_items[i])
        }
        for (let i = 0; i < weapons.length; i++) {
            selectElement(weapons[i], selected_weapons[i])
        }
        for (let i = 0; i < enchants.length; i++) {
            selectElement(enchants[i], selected_enchants[i])
        }
    }

    function select_prebis_mult(selected_items, selected_weapons, selected_enchants) {
        for (let option_name of armor_mult) {
            console.log(option_name);
            let select_option = document.getElementById(option_name);
            for (let option of select_option.options) {
                for (let item of selected_items) {
                    if (option.value === item) {
                        option.selected = true;
                        break;
                    } else {
                        option.selected = false;
                    }
                }
            }
        }

        let select_option = document.getElementById(weapons_mult[0]);
        console.log(select_option.options.length);
        for (let option of select_option.options) {
            for (let item of selected_weapons) {
                if (option.value === item) {
                    option.selected = true;
                    break;
                } else {
                    option.selected = false;
                }
            }
        }
        for (let i = 0; i < enchants.length; i++) {
            selectElement(enchants[i], selected_enchants[i])
        }
    }

    function load_p1prebisitems() {
        let selected_items = ["lionheart_helm", "eye_of_rend", "helm_of_valor", "mark_of_fordring", "imperial_jewel",
            "spaulders_of_valor", "truestrike_shoulders", "black_dragonscale_shoulders", "cape_of_the_black_baron", "blackveil_cloak",
            "black_dragonscale_chest", "savage_gladiator_chain", "vambraces_of_the_sadist", "battleborn_armbraces",
            "reiver_claws", "devilsaur_gauntlets", "brigam_girdle", "omokks_girth_restrainer", "eldritch_legplates",
            "devilsaur_leggings", "cloudkeeper_legplates", "black_dragonscale_leggings",
            "battlechasers_greaves", "black_dragonscale_boots", "painweaver_band",
            "blackstone_ring", "magnis_will", "tarnished_elven_ring",
            "blackhands_breadth", "hand_of_justice", "satyrs_bow"];
        let selected_weapons = ["dal_rends_sacred_charge", "dal_rends_tribal_guardian", "ironfoe", "thrash_blade", "mirahs_song"];
        let selected_enchants = ["+8 strength", "+30 attack_power", "+3 agility", "+4 stats", "+9 strength",
            "+7 strength", "+8 strength", "+7 agility", "crusader", "crusader"];
        select_prebis_mult(selected_items, selected_weapons, selected_enchants);
    }

    function load_p5pvebismult() {
        let selected_items = ["lionheart_helm", "barbed_choker", "mantle_of_wicked_revenge",
            "cloak_of_the_fallen_god", "breastplate_of_annihilation", "hive_defiler_wristguards",
            "gauntlets_of_annihilation", "onslaught_girdle", "conquerors_legguards",
            "chromatic_boots", "quick_strike_ring", "circle_of_applied_force",
            "jom_gabbar", "badge_of_the_swarmguard", "crossbow_of_imminent_doom"];
        let selected_weapons = ["chromatically_tempered_sword", "maladath"];
        let selected_enchants = ["+8 strength", "+30 attack_power", "+3 agility", "+4 stats", "+9 strength",
            "+7 strength", "+8 strength", "+7 agility", "crusader", "crusader"];
        select_prebis_mult(selected_items, selected_weapons, selected_enchants);
    }

    function load_p5pvebis() {
        let selected_items = ["lionheart_helm", "barbed_choker", "mantle_of_wicked_revenge",
            "cloak_of_the_fallen_god", "breastplate_of_annihilation", "hive_defiler_wristguards",
            "gauntlets_of_annihilation", "onslaught_girdle", "conquerors_legguards",
            "chromatic_boots", "quick_strike_ring", "circle_of_applied_force",
            "jom_gabbar", "badge_of_the_swarmguard", "crossbow_of_imminent_doom"];
        let selected_weapons = ["chromatically_tempered_sword", "maladath"];
        let selected_enchants = ["+8 strength", "+30 attack_power", "+3 agility", "+4 stats", "+9 strength",
            "+7 strength", "+8 strength", "+7 agility", "crusader", "crusader"];
        select_prebis(selected_items, selected_weapons, selected_enchants);
    }

    function load_p4pvebis() {
        let selected_items = ["lionheart_helm", "the_eye_of_hakkar", "drake_talon_pauldrons",
            "puissant_cape", "savage_gladiator_chain", "wristguards_of_stability",
            "flameguard_gauntlets", "onslaught_girdle", "legguards_of_the_fallen_crusader",
            "chromatic_boots", "quick_strike_ring", "circle_of_applied_force",
            "diamond_flask", "hand_of_justice", "strikers_mark"];
        let selected_weapons = ["chromatically_tempered_sword", "maladath"];
        let selected_enchants = ["+8 strength", "+30 attack_power", "+3 agility", "+4 stats", "+9 strength",
            "+7 strength", "+8 strength", "+7 agility", "crusader", "crusader"];
        select_prebis(selected_items, selected_weapons, selected_enchants);
    }

    function load_p3pvebis() {
        let selected_items = ["lionheart_helm", "onyxia_tooth_pendant", "drake_talon_pauldrons",
            "puissant_cape", "savage_gladiator_chain", "wristguards_of_stability",
            "flameguard_gauntlets", "onslaught_girdle", "legguards_of_the_fallen_crusader",
            "chromatic_boots", "quick_strike_ring", "circle_of_applied_force",
            "diamond_flask", "hand_of_justice", "strikers_mark"];
        let selected_weapons = ["chromatically_tempered_sword", "maladath"];
        let selected_enchants = ["+8 strength", "shoulder", "+3 agility", "+4 stats", "+9 strength",
            "+7 strength", "+8 strength", "+7 agility", "crusader", "crusader"];
        select_prebis(selected_items, selected_weapons, selected_enchants);
    }

    function load_p1prebis() {
        let selected_items = ["lionheart_helm", "mark_of_fordring", "truestrike_shoulders",
            "cape_of_the_black_baron", "savage_gladiator_chain", "battleborn_armbraces",
            "devilsaur_gauntlets", "omokks_girth_restrainer", "devilsaur_leggings",
            "battlechasers_greaves", "magnis_will", "blackstone_ring",
            "blackhands_breadth", "hand_of_justice", "satyrs_bow"];
        let selected_weapons = ["dal_rends_sacred_charge", "dal_rends_tribal_guardian"];
        let selected_enchants = ["+8 strength", "shoulder", "+3 agility", "+4 stats", "+9 strength",
            "+7 strength", "+8 strength", "boots", "crusader", "crusader"];
        select_prebis(selected_items, selected_weapons, selected_enchants);
    }

    function save_button() {
        read_inputs();
        let file_content = "";
        for (let i = 0; i < armor.length; i++) {
            file_content += armor[i] + " " + armor_input[i] + "\n";
        }
        for (let i = 0; i < weapons.length; i++) {
            file_content += weapons[i] + " " + weapons_input[i] + "\n";
        }
        for (let i = 0; i < enchants.length; i++) {
            let dd_string = enchants_input[i].slice(1, enchants_input[i].length);
            file_content += enchants[i] + " " + dd_string + "\n";
        }
        for (let i = 0; i < world_buffs.length; i++) {
            file_content += world_buffs[i] + " " + world_buffs_input[i] + "\n";
        }
        for (let i = 0; i < buffs.length; i++) {
            file_content += buffs[i] + " " + buffs_input[i] + "\n";
        }
        for (let i = 0; i < consumables.length; i++) {
            file_content += consumables[i] + " " + consumables_input[i] + "\n";
        }

        let var_array = ["n_simulations_dd", "n_simulations_stat_dd", "opponent_level_dd", "fight_time_dd",
            "sunder_armor_dd", "heroic_strike_rage_thresh_dd", "cleave_rage_thresh_dd", "whirlwind_rage_thresh_dd",
            "whirlwind_bt_cooldown_thresh_dd"];
        for (let variable of var_array) {
            file_content += variable + " " + parseFloat(document.getElementById(variable).value) + "\n";
        }

        for (let variable of stat_weigths) {
            if (document.getElementById(variable).checked) {
                file_content += variable + " " + variable + "\n";
            }
        }

        for (let variable of sim_options) {
            if (document.getElementById(variable).checked) {
                file_content += variable + " " + variable + "\n";
            }
        }

        file_content += "race_dd" + " " + race_string + "\n";

        uriContent = "data:application/octet-stream," + encodeURIComponent(file_content);
        saveAs(uriContent, "wow-fury-sim-config.txt")
    }

    function saveAs(uri, filename) {
        let link = document.createElement('a');
        if (typeof link.download === 'string') {
            document.body.appendChild(link); // Firefox requires the link to be in the body
            link.download = filename;
            link.href = uri;
            link.click();
            document.body.removeChild(link); // remove the link when done
        } else {
            location.replace(uri);
        }
    }

    function openTab(evt, cityName) {
        let i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(cityName).style.display = "block";
    }

    function read_inputs() {
        race = document.getElementById("race_dd");
        race_string = race.options[race.selectedIndex].value;

        world_buffs_input = [];
        for (let world_buff of world_buffs) {
            let temp = document.getElementById(world_buff);
            world_buffs_input.push((temp.checked) ? world_buff : "");
        }
        buffs_input = [];
        for (let buff of buffs) {
            let temp = document.getElementById(buff);
            buffs_input.push((temp.checked) ? buff : "");
        }
        consumables_input = [];
        for (let consumable of consumables) {
            let temp = document.getElementById(consumable);
            consumables_input.push((temp.checked) ? consumable : "");
        }

        armor_input = [];
        for (let armor_piece of armor) {
            let temp = document.getElementById(armor_piece);
            armor_input.push(temp.options[temp.selectedIndex].value);
        }

        weapons_input = [];
        for (let i = 0; i < weapons.length; i++) {
            let temp = document.getElementById(weapons[i]);
            weapons_input.push(temp.options[temp.selectedIndex].value);
        }

        armor_input_mult = [];
        for (let armor_piece of armor_mult) {
            let multi_select = document.getElementById(armor_piece);
            for (let i = 0; i < multi_select.options.length; i++) {
                if (multi_select.options[i].selected) {
                    armor_input_mult.push(multi_select.options[i].value);
                }
            }
        }

        weapons_input_mult = [];
        for (let weapon_id of weapons_mult) {
            let multi_select = document.getElementById(weapon_id);
            for (let i = 0; i < multi_select.options.length; i++) {
                if (multi_select.options[i].selected) {
                    weapons_input_mult.push(multi_select.options[i].value);
                }
            }
        }

        enchants_input = [];
        for (let i = 0; i < enchants.length; i++) {
            let temp = document.getElementById(enchants[i]);
            enchants_input.push(enchant_prefixes[i] + temp.options[temp.selectedIndex].value);
        }
    }

    var bar_chart_auras;
    var bar_chart_proc;
    var bar_chart_damage;
    var line_chart_hist;
    var line_chart_fight;
    var line_chart_fight_cum;

    function clean_charts() {
        try {
            bar_chart_auras.destroy();
            bar_chart_proc.destroy();
            bar_chart_damage.destroy();
            line_chart_hist.destroy();
            line_chart_fight.destroy();
            line_chart_fight_cum.destroy();
        } catch (error) {
            console.log(error)
        }
    }

    function show_loader() {
        $("#loader").addClass("loader");
    }

    function hide_loader() {
        $("#loader").removeClass("loader");
    }

    if ($(".run_sim_button").length) {
        $(".run_sim_button").click(function (event) {
            show_loader();
            setTimeout(myFunction, 100);
            setTimeout(hide_loader, 100);
            event.preventDefault();
        });
    }

    function myFunction() {

        clean_charts();
        read_inputs();

        let armor_vec = new Module.StringList();
        for (let armor_piece of armor_input) {
            armor_vec.push_back(armor_piece);
        }

        let weapons_vec = new Module.StringList();
        for (let wep of weapons_input) {
            weapons_vec.push_back(wep);
        }

        let compare_armor_vec = new Module.StringList();
        let compare_weapons_vec = new Module.StringList();
        if (document.getElementById("do_comparison").checked) {
            if (compare_armor_input.length === 15) {
                for (let armor_piece of compare_armor_input) {
                    compare_armor_vec.push_back(armor_piece);
                }
            }
            if (compare_weapons_input.length === 2) {
                for (let wep of compare_weapons_input) {
                    compare_weapons_vec.push_back(wep);
                }
            }
        }

        let mult_armor_vec = new Module.StringList();
        let mult_weapons_vec = new Module.StringList();
        if (document.getElementById("multiple_mode").checked) {
            for (let armor_piece of armor_input_mult) {
                if (armor_piece !== "none") {
                    mult_armor_vec.push_back(armor_piece);
                }
            }
            for (let wep of weapons_input_mult) {
                if (wep !== "none") {
                    mult_weapons_vec.push_back(wep);
                }
            }
        }

        let buff_vec = new Module.StringList();
        for (let buff of world_buffs_input) {
            buff_vec.push_back(buff);
        }
        for (let buff of buffs_input) {
            buff_vec.push_back(buff);
        }
        for (let buff of consumables_input) {
            buff_vec.push_back(buff);
        }
        let ench_vec = new Module.StringList();
        for (let ench of enchants_input) {
            ench_vec.push_back(ench);
        }

        let n_simulations_dd = parseFloat(document.getElementById("n_simulations_dd").value);
        if (isNaN(n_simulations_dd)) {
            n_simulations_dd = 20000;
        }
        n_simulations_dd = Math.min(Math.max(n_simulations_dd, 1), 1000000);

        let n_simulations_stat_dd = parseFloat(document.getElementById("n_simulations_stat_dd").value);
        if (isNaN(n_simulations_stat_dd)) {
            n_simulations_stat_dd = 20000;
        }
        n_simulations_stat_dd = Math.min(Math.max(n_simulations_stat_dd, 1), 50000);

        let opponent_level_dd = parseFloat(document.getElementById("opponent_level_dd").value);
        if (isNaN(opponent_level_dd)) {
            opponent_level_dd = 63;
        }
        opponent_level_dd = Math.min(Math.max(opponent_level_dd, 60), 63);

        let fight_time_dd = parseFloat(document.getElementById("fight_time_dd").value);
        if (isNaN(fight_time_dd)) {
            fight_time_dd = 60;
        }
        fight_time_dd = Math.min(Math.max(fight_time_dd, 10), 300);

        let sunder_armor_dd = parseInt(document.getElementById("sunder_armor_dd").value);
        if (isNaN(sunder_armor_dd)) {
            sunder_armor_dd = 5;
        }
        sunder_armor_dd = Math.min(Math.max(sunder_armor_dd, 0), 5);

        let max_optimize_time = parseInt(document.getElementById("max_optimize_time").value);
        if (isNaN(max_optimize_time)) {
            max_optimize_time = 90;
        }
        max_optimize_time = Math.min(Math.max(max_optimize_time, 60), 120);

        let options = new Module.StringList();
        for (let val of sim_options) {
            if (document.getElementById(val).checked) {
                options.push_back(val);
            }
        }

        let heroic_strike_rage_thresh = parseFloat(document.getElementById("heroic_strike_rage_thresh_dd").value);
        let cleave_rage_thresh = parseFloat(document.getElementById("cleave_rage_thresh_dd").value);
        let whirlwind_rage_thresh = parseFloat(document.getElementById("whirlwind_rage_thresh_dd").value);
        let whirlwind_bt_cooldown_thresh = parseFloat(document.getElementById("whirlwind_bt_cooldown_thresh_dd").value);
        let hamstring_cd_thresh = parseFloat(document.getElementById("hamstring_cd_thresh_dd").value);
        let hamstring_thresh = parseFloat(document.getElementById("hamstring_thresh_dd").value);
        let initial_rage = parseFloat(document.getElementById("initial_rage").value);

        let total_simulations = n_simulations_dd;
        if (document.getElementById("do_comparison").checked) {
            total_simulations *= 2;
        }
        let need_to_add_for_ap = true;
        let stat_weight_vec = new Module.StringList();
        if (document.getElementById("stat_weight_crit").checked) {
            stat_weight_vec.push_back("crit");
            total_simulations += n_simulations_stat_dd * 2 + n_simulations_stat_dd * 2 * need_to_add_for_ap;
            need_to_add_for_ap = false;
        }
        if (document.getElementById("stat_weight_hit").checked) {
            stat_weight_vec.push_back("hit");
            total_simulations += n_simulations_stat_dd * 2 + n_simulations_stat_dd * 2 * need_to_add_for_ap;
            need_to_add_for_ap = false;
        }
        if (document.getElementById("stat_weight_haste").checked) {
            stat_weight_vec.push_back("haste");
            total_simulations += n_simulations_stat_dd * 2 + n_simulations_stat_dd * 2 * need_to_add_for_ap;
            need_to_add_for_ap = false;
        }
        if (document.getElementById("stat_weight_extra_hit").checked) {
            stat_weight_vec.push_back("extra_hit");
            total_simulations += n_simulations_stat_dd * 2 + n_simulations_stat_dd * 2 * need_to_add_for_ap;
            need_to_add_for_ap = false;
        }
        if (document.getElementById("stat_weight_skill").checked) {
            stat_weight_vec.push_back("skill");
            total_simulations += n_simulations_stat_dd * 2 + n_simulations_stat_dd * 2 * need_to_add_for_ap;
        }

        let race_vec = new Module.StringList();
        race_vec.push_back(race_string);

        let obj = new Module['Sim_interface']();

        if (document.getElementById("multiple_mode").checked) {
            let wow_input = {
                race: race_vec,
                armor: mult_armor_vec,
                weapons: mult_weapons_vec,
                buffs: buff_vec,
                enchants: ench_vec,
                options: options,
                target_level: opponent_level_dd,
                fight_time: fight_time_dd,
                n_simulations: n_simulations_dd,
                n_simulations_stat_weights: n_simulations_stat_dd,
                sunder_armor: sunder_armor_dd,
                heroic_strike_rage_thresh: heroic_strike_rage_thresh,
                cleave_rage_thresh: cleave_rage_thresh,
                whirlwind_rage_thresh: whirlwind_rage_thresh,
                whirlwind_bt_cooldown_thresh: whirlwind_bt_cooldown_thresh,
                hamstring_cd_thresh: hamstring_cd_thresh,
                hamstring_thresh_dd: hamstring_thresh,
                initial_rage: initial_rage,
                max_optimize_time: max_optimize_time,
            };

            let result = obj.simulate_mult(wow_input);
            document.getElementById("output1").innerHTML = result['messages'].get(0);
            document.getElementById("output2").innerHTML = "";
            if (document.getElementById("display_multi_debug").checked) {
                document.getElementById("output2").innerHTML = result['messages'].get(1);
            }
            document.getElementById("output3").innerHTML = "";
            document.getElementById("output4").innerHTML = "";

        } else {
            let wow_input = {
                race: race_vec,
                armor: armor_vec,
                weapons: weapons_vec,
                buffs: buff_vec,
                enchants: ench_vec,
                stat_weights: stat_weight_vec,
                options: options,
                compare_armor: compare_armor_vec,
                compare_weapons: compare_weapons_vec,
                mult_armor: mult_armor_vec,
                mult_weapons: mult_weapons_vec,
                target_level: opponent_level_dd,
                fight_time: fight_time_dd,
                n_simulations: n_simulations_dd,
                n_simulations_stat_weights: n_simulations_stat_dd,
                sunder_armor: sunder_armor_dd,
                heroic_strike_rage_thresh: heroic_strike_rage_thresh,
                cleave_rage_thresh: cleave_rage_thresh,
                whirlwind_rage_thresh: whirlwind_rage_thresh,
                whirlwind_bt_cooldown_thresh: whirlwind_bt_cooldown_thresh,
                hamstring_cd_thresh: hamstring_cd_thresh,
                hamstring_thresh_dd: hamstring_thresh,
                initial_rage: initial_rage,
            };

            let result = obj.simulate(wow_input);

            let mean_dps = [];
            let std_dps = [];
            for (let i = 0; i < result['mean_dps'].size(); i++) {
                mean_dps.push(result['mean_dps'].get(i).toFixed(2));
                std_dps.push(result['std_dps'].get(i).toFixed(2));
            }

            let n_sim_status = "";
            if (mean_dps.length === 1) {
                let conf_interval = 1.96 * std_dps[0];
                n_sim_status += 'DPS: <b>' + mean_dps[0] + ' &plusmn ' + conf_interval.toPrecision(3) + '</b> (95% confidence interval)<br>';
            } else {
                for (let i = 0; i < mean_dps.length; i++) {
                    let j = i + 1;
                    let conf_interval = 1.96 * std_dps[i];
                    n_sim_status += 'DPS setup' + j + ': <b>' + mean_dps[i] + ' &plusmn ' +
                        conf_interval.toPrecision(3) + '</b> (95% confidence interval)<br>';
                }
            }

            n_sim_status += "Simulations for DPS = <b>" + n_simulations_dd + "</b><br>" +
                "Simulations for stat weights = <b>" + (total_simulations - n_simulations_dd) +
                "</b><br/>Total simulations: <b>" + total_simulations + "</b><br/> ";
            if (!document.getElementById("debug_on").checked) {
                n_sim_status += "TIP! Combat logs can be activated under the 'Open Simulation settings' dialog"
            }

            document.getElementById("output1").innerHTML = n_sim_status;
            document.getElementById("output3").innerHTML = result['messages'].get(0);

            let stat_weights = [];
            if (result['stat_weights'].size() > 0) {
                let ap_string = result['stat_weights'].get(0);
                ap_string = ap_string.split(" ");
                let dps_per_ap = parseFloat(ap_string[1]) / 100;
                let dps_per_ap_max = (parseFloat(ap_string[1]) + parseFloat(ap_string[2])) / 100;
                let dps_per_ap_min = (parseFloat(ap_string[1]) - parseFloat(ap_string[2])) / 100;
                for (let i = 1; i < result['stat_weights'].size(); i++) {
                    let stat_string = result['stat_weights'].get(i);
                    stat_string = stat_string.split(" ");
                    stat_weights.push({
                        'name': stat_string[0],
                        'value': parseFloat(stat_string[1]) / dps_per_ap,
                        'value_max': Math.max((parseFloat(stat_string[1]) + parseFloat(stat_string[2])) / dps_per_ap_min, 0),
                        'value_min': Math.max((parseFloat(stat_string[1]) - parseFloat(stat_string[2])) / dps_per_ap_max, 0),
                        'negative_value_max': Math.max((parseFloat(stat_string[3]) - parseFloat(stat_string[4])) / -dps_per_ap_min, 0),
                        'negative_value_min': Math.max((parseFloat(stat_string[3]) + parseFloat(stat_string[4])) / -dps_per_ap_max, 0)
                    });
                }
            }

            let string = "<b>Stat weights:</b> <br />";
            if (document.getElementById("do_comparison").checked) {
                string = "<b>Stat weights (Setup 1):</b> <br />";
            }
            if (result['stat_weights'].size() > 0) {
                for (let i = 0; i < stat_weights.length; i++) {
                    string += "+" + stat_weights[i]['name'] + " equivalates: <b>" + stat_weights[i]['value_min'].toFixed(2) +
                        " &#8722 " + stat_weights[i]['value_max'].toFixed(2) + "</b> attack power. <br />";
                    if (stat_weights[i]['name'] !== '1%ExtraHit') {
                        string += "-" + stat_weights[i]['name'] + " equivalates: <b>-" + stat_weights[i]['negative_value_min'].toFixed(2) +
                            " &#8722 -" + stat_weights[i]['negative_value_max'].toFixed(2) + "</b> attack power. <br />";
                    }
                    string += "<br />";
                }
            }
            document.getElementById("output2").innerHTML = string;

            // Crit cap details:
            document.getElementById("output4").innerHTML = result['extra_stats'].get(0);

            if (document.getElementById("debug_on").checked) {
                document.getElementById("combat_debug").style.display = "block";
                document.getElementById("combat_debug_title").innerHTML = "<b>Combat log from the median fight: </b>";
            } else {
                document.getElementById("combat_debug").style.display = "none";
                document.getElementById("combat_debug_title").innerHTML = "";
            }
            document.getElementById("combat_debug").innerHTML = result['extra_stats'].get(1);

            let aura_name = [];
            let aura_uptimes = [];
            for (let i = 0; i < result['aura_uptimes'].size(); i++) {
                let aura_string = result['aura_uptimes'].get(i);
                let split_string = aura_string.split(" ");
                aura_name.push(split_string[0]);
                aura_uptimes.push(parseFloat(split_string[1]));
            }

            let aura_list = [];
            for (let j = 0; j < aura_name.length; j++)
                aura_list.push({'name': aura_name[j], 'duration': aura_uptimes[j]});

            aura_list.sort(function (a, b) {
                return ((a.duration > b.duration) ? -1 : ((a.duration === b.duration) ? 0 : 1));
            });

            for (let k = 0; k < aura_list.length; k++) {
                aura_name[k] = aura_list[k].name;
                aura_uptimes[k] = aura_list[k].duration;
            }

            let proc_list = [];
            let proc_name = [];
            let proc_counter = [];
            for (let i = 0; i < result['proc_counter'].size(); i++) {
                let proc_string = result['proc_counter'].get(i);
                let split_string = proc_string.split(" ");
                proc_list.push({'name': split_string[0], 'counter': parseFloat(split_string[1])});
            }

            proc_list.sort(function (a, b) {
                return ((a.counter > b.counter) ? -1 : ((a.counter === b.counter) ? 0 : 1));
            });

            for (let k = 0; k < proc_list.length; k++) {
                proc_name[k] = proc_list[k].name;
                proc_counter[k] = proc_list[k].counter;
            }

            let colors = ["#3e95cd", "#8e5ea2", "#FFFF00", "#c45850", "#e8c3b9", "#990099", "#145A32", "#3333cc", "#FFFFFF"];
            let damage_name = [];
            let damage_vec = [];
            for (let i = 0; i < result["time_lapse_names"].size(); i++) {
                damage_name.push(result["time_lapse_names"].get(i));
                damage_vec.push([]);
                let damage_source_vec = result["damage_time_lapse"].get(i);
                if (i === 0) {
                    for (let j = 0; j < damage_source_vec.size(); j++) {
                        damage_vec[i].push(damage_source_vec.get(j));
                    }
                } else {
                    for (let j = 0; j < damage_source_vec.size(); j++) {
                        damage_vec[i].push(damage_source_vec.get(j) + damage_vec[i - 1][j]);
                    }
                }
            }

            let cumulative_vec = [];
            for (let i = 0; i < result["time_lapse_names"].size(); i++) {
                cumulative_vec.push([]);
                cumulative_vec[i][0] = damage_vec[i][0];
                for (let j = 1; j < damage_vec[i].length; j++) {
                    cumulative_vec[i].push(cumulative_vec[i][j - 1] + damage_vec[i][j]);
                }
            }

            let sources = [];
            for (let i = 0; i < result["time_lapse_names"].size(); i++) {
                sources.push(mean_dps[0] * result['dmg_sources'].get(i));
            }

            let time_stamps = [];
            time_stamps.push(0);
            for (let j = 1; j < damage_vec[0].length; j++) {
                time_stamps.push(time_stamps[j - 1] + .50);
            }

            let hist_x = [];
            let hist_y = [];
            for (let i = 0; i < result['hist_x'].size(); i++) {
                hist_x.push(parseInt(result['hist_x'].get(i)));
                hist_y.push(result['hist_y'].get(i));
            }

            let data_damage_time_lapse = [];
            for (let i = 0; i < damage_vec.length; i++) {
                data_damage_time_lapse.push(
                    {
                        data: damage_vec[i],
                        label: damage_name[i],
                        borderWidth: 10,
                        borderColor: colors[i],
                        backgroundColor: colors[i],
                        pointRadius: 0.1,
                        fill: origin
                    }
                )
            }

            let data_damage_time_lapse_cum = [];
            for (let i = 0; i < damage_vec.length; i++) {
                data_damage_time_lapse_cum.push(
                    {
                        data: cumulative_vec[i],
                        label: damage_name[i],
                        borderWidth: 10,
                        borderColor: colors[i],
                        backgroundColor: colors[i],
                        pointRadius: 0.1,
                        fill: origin
                    }
                )
            }

            Chart.defaults.global.defaultFontSize = 36;
            Chart.defaults.global.defaultFontStyle = 'Bold';
            Chart.defaults.scale.gridLines.color = "black";

            line_chart_hist = new Chart(document.getElementById("line-chart-hist"), {
                type: 'line',
                data: {
                    labels: hist_x,
                    datasets: [{
                        data: hist_y,
                        label: "Simulator results",
                        borderWidth: 10,
                        borderColor: "#3e95cd",
                        fill: origin,
                        backgroundColor: "#3e95cd"
                    }]
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: "black",
                        }
                    },
                    title: {
                        fontSize: 60,
                        fontColor: "black",
                        display: true,
                        text: 'Damage histogram'
                    },
                    scales: {
                        yAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0.5)",
                            },
                            ticks: {
                                fontColor: "black",
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Frequency',
                                fontColor: "black",
                            }
                        }],
                        xAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0.5)",
                            },
                            ticks: {
                                fontColor: "black",
                                maxTicksLimit: 30,
                                maxRotation: 0
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: 'DPS'
                            }
                        }]
                    }
                }
            });

            let canvas = document.getElementById("line-chart-hist");
            canvas.maintainAspectRatio = true;
            canvas.style.height = '450px';
            canvas.style.width = '675px';

            line_chart_fight = new Chart(document.getElementById("line-chart-fight"), {
                type: 'line',
                data: {
                    labels: time_stamps,
                    datasets: data_damage_time_lapse
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: "black",
                        }
                    },
                    bezierCurve: false,
                    title: {
                        fontSize: 60,
                        fontColor: "black",
                        display: true,
                        text: 'Fight time lapse (DPS)'
                    },
                    scales: {
                        yAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            ticks: {
                                fontColor: "black",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: 'Average damage'
                            }
                        }],
                        xAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            ticks: {
                                autoSkip: true,
                                maxTicksLimit: 30,
                                maxRotation: 0,
                                fontColor: "black",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: 'Time'
                            }
                        }],
                    }
                }
            });

            canvas = document.getElementById("line-chart-fight");
            canvas.maintainAspectRatio = true;
            canvas.responsive = false;
            canvas.style.height = '450px';
            canvas.style.width = '675px';

            line_chart_fight_cum = new Chart(document.getElementById("line-chart-fight-cumulative"), {
                type: 'line',
                data: {
                    labels: time_stamps,
                    datasets: data_damage_time_lapse_cum
                },
                options: {
                    legend: {
                        labels: {
                            fontColor: "black",
                        }
                    },
                    title: {
                        fontSize: 60,
                        fontColor: "black",
                        display: true,
                        text: 'Fight time lapse'
                    },
                    scales: {
                        yAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: 'Cumulative damage'
                            },
                            ticks: {
                                fontColor: "black",
                            },
                        }],
                        xAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            ticks: {
                                fontColor: "black",
                                maxTicksLimit: 30,
                                maxRotation: 0
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: 'Time'
                            }
                        }]
                    }
                }
            });

            canvas = document.getElementById("line-chart-fight-cumulative");
            canvas.maintainAspectRatio = true;
            canvas.style.height = '450px';
            canvas.style.width = '675px';

            // Bar chart
            bar_chart_damage = new Chart(document.getElementById("bar-chart-damage"), {
                type: 'bar',
                data: {
                    labels: damage_name,
                    datasets: [
                        {
                            backgroundColor: colors,
                            data: sources
                        }
                    ]
                },
                options: {
                    legend: {display: false},
                    title: {
                        fontSize: 60,
                        fontColor: "black",
                        display: true,
                        text: 'DPS from different sources'
                    },
                    scales: {
                        yAxes: [{
                            fontColor: "black",
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: 'DPS'
                            },
                            ticks:
                                {
                                    fontColor: "black",
                                    beginAtZero: true,
                                    suggestedMin: 0,
                                }
                        }],
                        xAxes: [{
                            fontColor: "black",
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: false,
                            },
                            ticks:
                                {
                                    fontColor: "black",
                                    beginAtZero: true,
                                    suggestedMin: 0,
                                }
                        }]
                    }
                }
            });

            canvas = document.getElementById("bar-chart-damage");
            canvas.maintainAspectRatio = true;
            canvas.style.height = '450px';
            canvas.style.width = '675px';

            // Bar chart
            bar_chart_auras = new Chart(document.getElementById("bar-chart-auras"), {
                type: 'bar',
                data: {
                    labels: aura_name,
                    datasets: [
                        {
                            backgroundColor: colors,
                            data: aura_uptimes
                        }
                    ]
                },
                options: {
                    legend: {display: false},
                    title: {
                        fontColor: "black",
                        fontSize: 60,
                        display: true,
                        text: 'Aura uptime'
                    },
                    scales: {
                        yAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                                labelString: '%',
                            },
                            ticks:
                                {
                                    fontColor: "black",
                                    beginAtZero: true,
                                    suggestedMin: 0,
                                }
                        }],
                        xAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            ticks:
                                {
                                    fontColor: "black",
                                    beginAtZero: true,
                                }
                        }],
                    }
                }
            });

            canvas = document.getElementById("bar-chart-auras");
            canvas.maintainAspectRatio = true;
            canvas.style.height = '450px';
            canvas.style.width = '675px';

            // Bar chart
            bar_chart_proc = new Chart(document.getElementById("bar-chart-proc"), {
                type: 'bar',
                data: {
                    labels: proc_name,
                    datasets: [
                        {
                            backgroundColor: colors,
                            data: proc_counter
                        }
                    ]
                },
                options: {
                    legend: {display: false},
                    title: {
                        fontColor: "black",
                        fontSize: 60,
                        display: true,
                        text: 'Average # of procs'
                    },
                    scales: {
                        yAxes: [{
                            gridLines: {
                                color: "rgba(0, 0, 0, 0)",
                            },
                            scaleLabel: {
                                fontColor: "black",
                                display: true,
                            },
                            ticks:
                                {
                                    fontColor: "black",
                                    beginAtZero: true,
                                }
                        }],
                        xAxes: [{
                            gridLines: {
                                fontColor: "black",
                                color: "rgba(0, 0, 0, 0)",
                            },
                            ticks:
                                {
                                    fontColor: "black",
                                    beginAtZero: true,
                                }
                        }],
                    }
                }
            });

            canvas = document.getElementById("bar-chart-proc");
            canvas.maintainAspectRatio = true;
            canvas.responsive = false;
            canvas.style.height = '450px';
            canvas.style.width = '675px';
        }
    }
</script>

<script src="emscripten/wow_interface.js"></script>
</body>
